{"version":3,"sources":["components/header/AppHeader.jsx","components/footer/Footer.jsx","components/modals/HeaderMessage.jsx","components/modals/SemanticModal.jsx","components/helperfunctions/HelperFunctions.jsx","components/comparevisualization/CompareVisualization.jsx","components/three/Scene.jsx","content/semanticex/SemanticEx.jsx","components/modals/ModelsModal.jsx","content/modelex/ModelEx.jsx","content/faq/FAQ.jsx","components/Main.jsx","serviceWorker.js","index.js","images/bgwhite.png"],"names":["AppHeader","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","showpanel","setState","console","log","react_default","a","createElement","UIShell","aria-label","prefix","className","src","alt","react_router_dom","exact","to","onClick","showPanel","bind","_20_default","onBlur","headerPanelBlur","expanded","ref","role","href","Component","Footer","target","HeaderMessage","rel","SemanticModalContent","modals_HeaderMessage","registerGAEvent","componentName","eventCategory","eventAction","componentLoadTime","eventTime","Date","getTime","ReactGA","event","category","action","value","label","abbreviateString","maxLength","length","substring","intlFormat","num","Intl","NumberFormat","format","Math","round","makeFriendly","abs","loadJSONData","url","fetch","then","response","status","json","data","catch","err","checkInView","container","element","partial","containerOffset","elementOffset","cTop","scrollTop","cBottom","clientHeight","eTop","offsetTop","eBottom","initialize","LeaderLine","window","animOptions","duration","timing","greyColor","blueColor","CompareVisualization","modelDetails","datasetdictionary","modelsList","loadingCompare","bestModels","layerScores","maxindex","miniChartWidth","chartWidth","miniChartHeight","chartHeight","overallBestScore","overallBestModel","layer","model","_this2","simArr","slice","topx","allDictionary","dictionary","dataset","selectedCat","selectedimage","modelScore","totalScore","i","weightedScore","toFixed","undefined","push","name","index","layer_index","score","numLayers","_","maxVal","indexOf","maxvalue","drawChart","keys","numModels","backStrokes","document","getElementsByClassName","textBoxes","setAttribute","classList","remove","bestModelsMap","forEach","each","_this3","self","layers","metric","genGraphData","margin","width","height","x","d3","range","padding","y","svg","append","attr","domain","map","d","selectAll","enter","bandwidth","on","text","min","style","yAxis","tickSize","g","select","xAxis","toUpperCase","compareModels","selectedImagePath","bestModelsList","best","key","InlineLoading","description","Scene","start","assertThisInitialized","stop","animate","legend","layerindex","highlightedindex","mountingStuff","setSelected","setselected","prevProps","prevState","dml","highlightPoint","pointData","loadData","mount","clientWidth","fov","near","far","tweenDuration","scene","THREE","camera","circle_sprite","load","texture","xhr","loaded","total","renderer","antialias","geometry","material","color","cube","setClearColor","setSize","pointScale","addEventListener","resizeHandler","appendChild","domElement","zoom","scaleExtent","getScaleFromZ","zoomHandler","view","setUpZoom","raycaster","params","Points","threshold","_d3$mouse","node","_d3$mouse2","slicedToArray","mouse_position","checkIntersects","lastSeenIndex","removeHighlights","tooltipbox","display","hoverContainer","add","models","random","innerWidth","aspect","updateProjectionMatrix","datum","vertices","legendMap","get","class","colors","g2","size","sizeAttenuation","vertexColors","transparent","m2","point","p2","_this$hoverContainer","apply","toConsumableArray","children","mouseX","mouseY","mouse_vector","mouseToThree","setFromCamera","intersects","intersectObject","points","sortIntersectsByDistanceToRay","tooltipimg","tooltip","innerHTML","backgroundColor","left","top","body","cursor","hideTooltip","d3_transform","transform","scale","k","z","getZFromScale","position","set","refs","camerazoom","camera_z_position","half_fov","half_fov_radians","toRadians","fov_height","tan","angle","PI","radius","pt_angle","pt_radius_sq","sqrt","cos","sin","initial_scale","initial_transform","translate","loadedJSON","createPoints","pointsGeometry","pointsBufferGeometry","Map","legendArray","xRange","max","yRange","vert","numVertices","positions","Float32Array","offsets","colorsBF","addAttribute","l","has","zoomOutCamera","attributes","array","tween","TWEEN","easing","Linear","None","onUpdate","needsUpdate","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","vertex","return","pointsMaterial","background","removeChild","removeEventListener","frameId","requestAnimationFrame","cancelAnimationFrame","renderScene","render","legendList","SemanticEx","require","similarityArray","selecteddataset","selectedmodel","selectedsimimage","hoversimimage","selectedlayer","selectedmetric","datasetArray","datasetsList","distanceMetricList","showorientationmodal","pageviewed","showmodelconfig","showumap","showdatasetmodal","showtopresults","viewdatasetby","showadvanced","showcomparemodal","updateSimilarity","loadDatasetList","searchCount","lineHolder","lastclicked","keyFunction","scrollEndedHandler","clearTimeout","isScrolling","setTimeout","drawLines","selectedModel","nextIndex","getNextVisible","selectedLayer","getNextVisibleLayer","e","removeLines","modelVisible","incs","line","startPlug","endPlug","startPlugColor","path","hide","startSocket","endSocket","endPlugSize","querySelector","zIndex","show","LayerScrollTop","newVal","val","newState","getNextVal","isNaN","numNeurons","layerList","selectedneuron","keyCode","cycleLayerModel","title","componentLoadedTime","showTopResults","recolorLines","layerscrollbox","scrollTo","behavior","getAttribute","setSelectedImage","incorrectResults","opacity","dArray","datasetImageList","dsdata","iconPath","icon","clickDatasetImage","indexvalue","modelImageList","mdata","imagePath","clickModelImage","layerImageList","ldata","modelparameters","clickLayerImage","metricImageList","clickMetricImage","datasetClasses","datasetClassImagesList","similarImagesList","clist","classval","onMouseOver","hoverSimilarImage","clickSimilarImage","header","alldata","widthVal","similarityScore","simCount","datasetimagesList","Modal","open","passiveModal","primaryButtonText","modalHeading","modalLabel","onRequestSubmit","toggleSemanticModal","onRequestClose","SemanticModal","secondaryButtonText","toggleShowCompare","comparevisualization_CompareVisualization","toggleDatasetModal","Toggle","id","labelA","labelB","onToggle","toggleAdvancedOptions","toggleModelConfig","numlayers","Tooltip","direction","triggerText","type","toggleUMAPView","three_Scene","toggleTopX","toggleViewDatasetBy","viewby","ModelsModalContent","TableContainer","DataTable","Table","TableHead","TableRow","TableBody","TableCell","TableHeader","headers","ModelEx","modelDetailsViz","_model$layer","neuronList","layersList","showmodelorientationmodal","showmoremodelinfomodal","showneuronsubset","numneuronsshow","pageIntro","updateModelState","updateLayerState","queryString","location","includes","_queryString$parse","parse","channel","_loop","j","getNeuronList","_this$getSelections","getSelections","updateNeuronList","_this4","_this$getSelections2","preventDefault","neuron","modelname","encodeURIComponent","_this5","toLowerCase","onKeyPress","kepressLayer","neuronImageList","clickNeuronImage","pathinfo","neuronindex","toggleModelsModal","ModelsModal","toggleModelMoreInfoModal","rows","all_layers","_ref","getHeaderProps","row","cells","cell","parametercount","numneurons","toggleViewNeuronSubset","twitterShare","FAQ","algebraIntro","alert","pageview","pathname","search","history","createBrowserHistory","basename","forceRefresh","keyLength","getUserConfirmation","message","callback","confirm","linkHolder","updateLh","hash","listen","Main","header_AppHeader","react_router","component","semanticex_SemanticEx","lh","modelex_ModelEx","replace","footer_Footer","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onSuccess","error","ReactDOM","components_Main","getElementById","URL","process","origin","concat","contentType","ready","unregister","reload","checkValidServiceWorker","module","exports"],"mappings":"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","file":"static/js/main.e8eaee5e.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport {\n    Header,\n    HeaderName,\n    HeaderNavigation,\n    //   HeaderMenuItem,\n    HeaderGlobalBar,\n    HeaderPanel,\n    Switcher,\n    SwitcherItem,\n    SwitcherDivider,\n    HeaderGlobalAction,\n    SkipToContent,\n} from 'carbon-components-react/lib/components/UIShell';\n\nimport {\n    NavLink\n} from \"react-router-dom\";\n\nimport \"./header.css\"\n// import Notification20 from '@carbon/icons-react/lib/notification/20';\n// import UserAvatar20 from '@carbon/icons-react/lib/user--avatar/20';\nimport AppSwitcher20 from '@carbon/icons-react/lib/app-switcher/20';\n\nclass AppHeader extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showpanel: false\n        }\n    }\n\n    showPanel() {\n        this.setState({ showpanel: !this.state.showpanel })\n        // this.refs[\"tester\"].focus()\n        // console.log(this.refs[\"switchermenu\"])\n    }\n\n    headerPanelBlur() {\n        this.setState({ showpanel: false })\n        console.log(\"blur\")\n    }\n\n    render() {\n        return (\n            <div>\n                <Header aria-label=\"Convolutional Neural Network Playground\">\n                    <SkipToContent />\n                    <HeaderName prefix=\"\">\n                        {/* <div className=\"decornone \"><NavLink exact to=\"/\"> </NavLink></div> */}\n                        <img className=\"headericon\" src=\"images/icon.png\" alt=\"\" />\n                        ConvNet Playground\n\n                    </HeaderName>\n                    <HeaderNavigation aria-label=\"Convolutional Neural Network Playground\">\n                        {/* <HeaderMenuItem element={Link} to=\"/\" className=\"navbarlink \"> Datasets </HeaderMenuItem> */}\n                        {/* <HeaderMenuItem  element={Link} to=\"/models\" className=\"navbarlink \"> Models</HeaderMenuItem> */}\n                        <div className=\"navbarlinks  \"><NavLink exact to=\"/\"> Semantic Search </NavLink></div>\n                        <div className=\"navbarlinks \"><NavLink to=\"/models\"> Model Explorer </NavLink></div>\n                        <div className=\"navbarlinks \"><NavLink to=\"/faq\"> FAQ </NavLink></div>\n                        {/* <div className=\"navbarlinks \"><NavLink to=\"/algebra\"> Image Algebra </NavLink></div> */}\n                        {/* <div className=\"navbarlinks \"><NavLink to=\"/energy\"> Energy Explorer </NavLink></div> */}\n                    </HeaderNavigation>\n                    <HeaderGlobalBar>\n                        {/* <HeaderGlobalAction aria-label=\"Notifications\">\n                    <Notification20 />\n                </HeaderGlobalAction>\n                */}\n                        {/* <HeaderGlobalAction aria-label=\"User Avatar\">\n                    <UserAvatar20 />\n                </HeaderGlobalAction> */}\n                        <HeaderGlobalAction\n                            onClick={this.showPanel.bind(this)}\n                            aria-label=\"App Switcher\">\n                            <AppSwitcher20 />\n                        </HeaderGlobalAction>\n                    </HeaderGlobalBar>\n                    <HeaderPanel aria-label=\"Header Panel\" onBlur={this.headerPanelBlur.bind(this)} expanded={this.state.showpanel} >\n                        <Switcher ref=\"switchermenu\" role=\"menu\" aria-label=\"Switcher Container\">\n\n                            <SwitcherItem ref=\"faqbutton\" aria-label=\"Link 1\" href=\"#/\" > Semantic Search</SwitcherItem>\n                            <SwitcherItem ref=\"faqbutton\" aria-label=\"Link 1\" href=\"#/models\" > Model Explorer</SwitcherItem>\n                            <SwitcherDivider />\n                            <SwitcherItem ref=\"faqbutton\" aria-label=\"Link 1\" href=\"#/faq\" >FAQ</SwitcherItem>\n                            <SwitcherDivider />\n                            {/* <SwitcherItem href=\"#\" aria-label=\"Link 2\">\n                                Link 2\n                            </SwitcherItem>\n                            <SwitcherItem href=\"#\" aria-label=\"Link 3\">\n                                Link 3\n                            </SwitcherItem> */}\n\n                        </Switcher>\n                    </HeaderPanel>\n                </Header>\n                <div> <br /> <br />  <br />  <br /> </div>\n            </div>\n\n        );\n    }\n}\n\nexport default AppHeader;\n","import React, { Component } from \"react\";\nimport \"./footer.css\"\n\nclass Footer extends Component {\n    render() {\n        return (\n            <div>\n                Made with <span className=\"redcolor\">&#9829;</span> at <a href=\"http://experiments.fastforwardlabs.com/\" target=\"blank\">Cloudera Fast Forward Labs</a>.\n            </div>\n        );\n    }\n}\n\nexport default Footer;","import React, { Component } from \"react\";\n\nclass HeaderMessage extends Component {\n    constructor(props) {\n        super(props)\n\n    }\n    render() {\n        return (\n            <div>\n                <div className=\"greyhighlight p10 mb10\">\n                    Click the  [<strong> ? More Info </strong>] link on the top right to show this dialog at any time.\n                </div>\n                Convnet Playground -  <i>a tool for the interactive exploration of Convolutional Neural Networks (Convnets or CNNs)</i> -\n               is a research prototype by Cloudera Fast Forward Labs, built to accompany our\n                report on <a href=\"https://blog.fastforwardlabs.com/2019/07/22/new-research-deep-learning-for-image-analysis.html\" target=\"_blank\" rel=\"noopener noreferrer\" > Deep Learning for Image Analysis</a>.\n                {/* More about this report is described in our blog post. */}\n\n\n            </div>\n        );\n    }\n}\n\nexport default HeaderMessage;","import React, { Component } from \"react\";\nimport HeaderMessage from \"./HeaderMessage\"\nclass SemanticModalContent extends Component {\n    render() {\n        return (\n            <div className=\"mr10\">\n                <HeaderMessage></HeaderMessage>\n\n                <br />\n                This section of the prototype allows you to perform <strong>semantic image search</strong>  using convolutional neural networks.\n                When you select an image (by clicking it), a neural network looks at the content of all\n                images in our dataset and shows you the top most similar images to the selected image.\n\n                <br />\n\n\n\n                <div className=\"horrule mb10 pt10\"></div>\n                <div className=\"boldtext\"> Convolutional Neural Netwoks</div>\n                CNNs learn hierarchical representations\n                useful for image analysis. Early layers in a CNN learn low level features (e.g. lines, edges, shapes, colours)\n                while later layers learn high level concepts (e.g eyes, legs, faces, doors etc) depending on the dataset used for training.\n\n\n\n                <div className=\"boldtext mt10\"> Extracting Similarity Using Convolutional Networks </div>\n                Semantic search explores the use features extracted (embeddings) from images using layers in a CNN to compute the \"similarity\" between images.\n                We have precomputed the extracted features from images in 4 datasets using 8 different CNN models (pretrained on imagenet)\n                and 8 <i>selected layers </i> from each model. We have also computed the similarity\n                between all of these features using 4 different similarity metrics. This demo allows you interactively explore the results of these computations.\n                Start by performing a search query (clicking an image).\n\n                {/* <img className=\" mt10 w100\" src={process.env.PUBLIC_URL + \"/assets/semsearch/images/embed.jpg\"} alt=\"\" />\n                <div className=\"smalldesc mb10\">Clicking on an image shows the top similar returned based on embeddings from a CNN model.</div> */}\n                <br />\n                Do different models (e.g vgg19 vs ResNet50) perform differently?\n                How do the embeddings they generate differ?\n                How do layers compare?\n                You can explore these questions by enabling \"advanced options\"  - selecting various search\n                configurations, viewing UMAP visualizations of embeddings from each layer, and using\n                the <span className=\"italics\">compare models</span> button.\n\n                {/* <img className=\" mt10 w100\" src={process.env.PUBLIC_URL + \"/assets/semsearch/images/config.gif\"} alt=\"\" />\n                <div className=\"smalldesc mb10\">Use the search configuration panel to try different datasets, models, layers and distance metrics</div> */}\n\n                <br />\n\n\n                The <strong> search results score </strong>  is the percentage of returned results that belong to the same category\n                as the selected image, weighted by position in the result list i.e correct results that are ranked top of the\n                           result list get more points compared to correct results at the end of the list.\n                For example, for a search query which is an image of a Banana, the search score will be 100%\n                if all returned images all belong to the same category  (Bananas).\n                Note that this score is conservative - some images may belong to different classes\n                but are <span className=\"italics\"> also similar </span> (e.g sedan, beetle, ferrari are <span className=\"italics\">all</span> cars).\n                The search score can be used to easily compare  the performance of each search configuration.\n\n\n\n                <div className=\"boldtext mt10\"> Models and Layers</div>\n                We provide results from 9 models (vgg16, vgg19, mobilenet, efficientnetb0,efficientnetb5, xception, resnet50, inceptionv3, densenet121)\n                and a selection intermediate models using 8 layers from each model. We use only 8 layers mainly to reduce the viewer's cognitive burden\n                and enable easy visual comparisons.\n                However, the selection of <span className=\"italics\">which</span> layers to use is guided by the\n                following - first we focus on convolutional layers with trainable parameters\n                and we include the first and last convolutional layer in each model. Finally, we\n                select a random sample of 6 convolutional layers in between.\n                The models are presented in order of increasing complexity (number of parameters)\n                and show marked differences in their ability to generate features that correctly identify similar images.\n\n                <div className=\"boldtext mt10\"> Distance Metric </div>\n                We provide results that from the use of 4 different distance metrics in measuring the similarity between\n                features extracted from all images in each dataset. These include cosine, euclidean, squared euclidean and minkowsi distances.\n                <br /> Hint: Cosine works best.\n\n\n                <div className=\"boldtext mt10\"> Datasets </div>\n\n                <strong> [Iconic200] </strong> This is a dataset of real world images collected from Flickr (creative commons).\n                It contains images spanning 10 keyword searches (arch, banana, volkswagen beetle, eiffel tower, empire state building, ferrari, pickup truck, sedan, stonehenge, tractor).\n                These images are chosen deliberately with conceptual overlaps (several car brands, similar colors across classes) which can be challenging to distinguish.\n                This in turn offers opportunity to evaluate how various models hand these overlaps.\n                <br />\n\n                <strong> [Fashion200] </strong>  A collection of 200 images (10 categories) of real fashion models from\n                the <a href=\"https://www.kaggle.com/paramaggarwal/fashion-product-images-dataset\" target=\"_blank\" rel=\"noopener noreferrer\">Kaggle Fashion Product Images Dataset</a> .\nImages have a max width of 300px. Categories include flipflops, menjeans, menshirt, mentshirt, sandals, sportshoe, womenheels, womenjeans, womentshirt.\n                <br />\n\n                <strong>[TinyImagenet200]</strong>  This dataset contains 64px * 64px images and is a subset (200) of\n                the <a href=\"https://tiny-imagenet.herokuapp.com/\" target=\"_blank\" rel=\"noopener noreferrer\" >Tiny Imagenet Visual Recognition Challenge dataset.</a> It consists of\n                images from 10 categories (arch, bottle, bridge, bus, face, frog, goldfish, sandals, teapot, tractor).\n                <br />\n\n                <strong>[Cifar10] </strong> This is a subset (200 images) of the popular\n                <a href=\"https://www.cs.toronto.edu/~kriz/cifar.html\" target=\"_black\"> cifar10 </a>  dataset\n                containing 20 images from 10 randomly selected classes. Each image is 32px by 32px in dimension.\n\n                <br />\n                <br />\n            </div>\n        );\n    }\n}\n\nexport default SemanticModalContent;","import ReactGA from 'react-ga';\nReactGA.initialize(\"UA-53030428-17\")\n\nexport function registerGAEvent(componentName, eventCategory, eventAction, componentLoadTime) {\n    let eventTime = (new Date()).getTime() - componentLoadTime\n    // console.log(\"GA\", eventCategory, eventTime, eventAction, componentName)\n    ReactGA.event({\n        category: eventCategory,\n        action: eventAction,\n        value: eventTime,\n        label: componentName\n    });\n}\n\nexport function abbreviateString(value, maxLength) {\n    if (value.length <= maxLength) {\n        return value\n    } else {\n        let retval = value.substring(0, maxLength) + \" ..\"\n        return retval\n    }\n}\n\nexport function boundWidth(widthVal) {\n    if (widthVal < 0) {\n        return 0;\n    } else if (widthVal > 1) {\n        return 1;\n    } else {\n        return widthVal;\n    }\n}\n\nfunction intlFormat(num) {\n    return new Intl.NumberFormat().format(Math.round(num * 10) / 10);\n}\nexport function makeFriendly(num) {\n    if (num < 1 && num > 0) {\n        return num\n    }\n    if (Math.abs(num) >= 1000000)\n        return intlFormat(num / 1000000) + 'M';\n    if (Math.abs(num) >= 1000)\n        return intlFormat(num / 1000) + 'k';\n    return intlFormat(num);\n}\n\nexport function loadJSONData(url) {\n    return fetch(url)\n        .then(\n            function (response) {\n                if (response.status !== 200) {\n                    console.log('Looks like there was a problem. Status Code: ' + response.status);\n                    return;\n                }\n                // Examine the text in the response\n                //    response.text().then(function(data){\n                //        console.log(data)\n                //    })\n                return response.json().then(function (data) {\n                    return data\n                });\n            }\n        )\n        .catch(function (err) {\n            console.log('Fetch Error :-S', err);\n        });\n}\n\nexport function ColorArray() {\n    let colorArray = [\n        \"#1f78b4\",\n        \"#b2df8a\",\n        \"#33a02c\",\n        \"#fb9a99\",\n        \"#e31a1c\",\n        \"#fdbf6f\",\n        \"#ff7f00\",\n        \"#6a3d9a\",\n        \"#cab2d6\",\n        \"#ffff99\",\n        \"#8fff4f\"\n    ]\n    return colorArray\n}\n\n\nexport function ColorArrayRGB() {\n    let colorArray = [\n        [141, 211, 199],\n        [255, 255, 179],\n        [190, 186, 218],\n        [251, 128, 114],\n        [128, 177, 211],\n        [253, 180, 98],\n        [179, 222, 105],\n        [252, 205, 229],\n        [188, 128, 189],\n        [204, 235, 197],\n    ]\n    return colorArray\n}\n\nexport function checkInView(container, element, partial, containerOffset, elementOffset) {\n\n    if (container) {\n        //Get container properties\n        let cTop = container.scrollTop;\n        let cBottom = cTop + container.clientHeight + containerOffset;\n\n        //Get element properties\n        let eTop = element.offsetTop + elementOffset;\n        let eBottom = eTop + element.clientHeight;\n\n        //Check if in view    \n        let isTotal = (eTop >= cTop && eBottom <= cBottom);\n        let isPartial = partial && (\n            (eTop < cTop && eBottom > cTop) ||\n            (eBottom > cBottom && eTop < cBottom)\n        );\n\n        //Return outcome\n        // console.log(\"cT:\", cTop, \"conHei\", container.clientHeight, \" offset\", containerOffset, elementOffset, container.offsetTop)\n        // console.log(element.offsetTop, \"eT:\", eTop, \"cT:\", cTop, \"eB:\", eBottom, \"cB:\", cBottom, isTotal || isPartial)\n        return (isTotal || isPartial);\n    } else {\n        return false\n    }\n\n\n}\n\nexport const LeaderLine = window.LeaderLine;\nexport const animOptions = { duration: 800, timing: 'ease' }\nexport const greyColor = \"rgba(189, 195, 199, 0.5)\"\nexport const blueColor = 'rgba(0,98,255, 1)'\n","import React, { Component } from 'react'\n// import * as LeaderLine from 'leader-line'\nimport \"./comparevisualization.css\"\nimport * as _ from 'lodash'\nimport { InlineLoading } from 'carbon-components-react';\nimport { loadJSONData } from \"../helperfunctions/HelperFunctions\"\nimport * as d3 from \"d3\"\n\nclass CompareVisualization extends Component {\n    constructor(props) {\n        super(props)\n\n        const modelDetails = this.props.data.modelDetails; // require('../../assets/semsearch/details.json');\n        this.datasetdictionary = this.props.data.datasetdictionary; //require('../../assets/semsearch/datasetdictionary.json');\n\n\n\n        this.state = {\n            modelsList: modelDetails[\"models\"],\n            loadingCompare: true,\n            bestModels: []\n        }\n\n        this.layerScores = { data: [], maxindex: 0 }\n        this.miniChartWidth = this.props.data.chartWidth\n        this.miniChartHeight = this.props.data.chartHeight\n        this.overallBestScore = 0\n        this.overallBestModel = \"\"\n    }\n\n\n\n    genGraphData(data, layer, model) {\n        let simArr = data.slice(1, this.props.data.topx + 1)\n        let allDictionary = this.datasetdictionary.dictionary[this.props.data.dataset]\n        let selectedCat = allDictionary[this.props.data.selectedimage]\n        let [modelScore, totalScore] = [0, 0]\n        for (var i in simArr) {\n            if (selectedCat == allDictionary[simArr[i][0]]) {\n                modelScore += (this.props.data.topx - i) / this.props.data.topx\n            }\n            totalScore += (this.props.data.topx - i) / this.props.data.topx\n        }\n        let weightedScore = ((modelScore / totalScore) * 100).toFixed(1)\n\n        if (this.layerScores[model] == undefined) {\n            this.layerScores[model] = { data: [], maxindex: 0 }\n        }\n\n\n        this.layerScores[model].data.push({ layer: layer.name, index: layer.layer_index, score: weightedScore * 1 })\n\n        // check if we have all layers for current model\n        if (this.layerScores[model].data.length == this.props.data.numLayers) {\n            this.layerScores[model].data = _.sortBy(this.layerScores[model].data, 'index');\n            let maxVal = _.maxBy(this.layerScores[model].data, \"score\")\n\n            this.layerScores[model].maxindex = this.layerScores[model].data.indexOf(maxVal)\n            this.layerScores[model].maxvalue = maxVal.score\n            this.layerScores[model].model = model\n            // console.log(\"all data in\", this.layerScores[model])\n\n            this.drawChart(this.layerScores[model])\n\n            if (maxVal.score > this.overallBestScore) {\n                this.overallBestScore = maxVal.score\n                this.overallBestModel = model\n            }\n\n            // console.log(\"Total\", Object.keys(this.layerScores).length);\n            if (Object.keys(this.layerScores).length == this.props.data.numModels) {\n                // console.log(\"All models have been computed\");\n                this.setState({ loadingCompare: false })\n                // console.log(\"Overall bases\", this.overallBestModel)\n                let backStrokes = document.getElementsByClassName(\"backstroke\" + this.overallBestScore)\n                let textBoxes = document.getElementsByClassName(\"topmodel\" + this.overallBestScore)\n                for (let i = 0; i < backStrokes.length; i++) {\n                    backStrokes[i].setAttribute(\"stroke\", \"green\")\n                }\n\n                for (let i = 0; i < textBoxes.length; i++) {\n                    textBoxes[i].classList.remove(\"displaynone\")\n                }\n\n                // this.layerScores.forEach(each => {\n                //     if (each.data.score = this.overallBestScore) {\n                //         console.log(each.data)\n                //     }\n                // });\n                let bestModels = []\n                let bestModelsMap = {}\n                for (model in this.layerScores) {\n                    let currentData = this.layerScores[model].data\n                    currentData.forEach(each => {\n                        if (each.score == this.overallBestScore) {\n                            each[\"model\"] = model\n                            if (bestModelsMap[model] == undefined) {\n                                bestModels.push(each)\n                                bestModelsMap[model] = \"\"\n                            }\n\n                        }\n                    });\n                }\n                // console.log(bestModels)\n                this.setState({ bestModels: bestModels })\n\n\n            }\n        }\n\n\n    }\n\n\n    compareModels() {\n        let self = this\n        // let selectedNum = Math.round(Math.random() * 200) \n\n        this.layerScores = {}\n\n        this.state.modelsList.forEach((model, i) => {\n            let layers = this.state.modelsList[i].layers\n            layers.forEach(layer => {\n\n                let similarityPath = process.env.PUBLIC_URL + \"/assets/semsearch/similarity/\" + self.props.data.dataset + \"/\" + model.name + \"/\" + self.props.data.metric + \"/\" + layer.name + \".json\"\n                let loadedJSON = loadJSONData(similarityPath)\n                loadedJSON.then(function (data) {\n                    if (data) {\n                        // console.log(self.props.data.selectedimage + \"\")\n                        self.genGraphData(data[self.props.data.selectedimage + \"\"], layer, model.name)\n                    }\n                })\n            });\n        });\n\n\n\n    }\n\n    drawChart(layerScores) {\n        let self = this\n        let data = layerScores.data\n        // const data = [12, 5, 6, 6, 9, 10];\n        // const data = [{ sales: 10, salesperson: \"lenny\" }, { sales: 8.4, salesperson: \"harper\" }, { sales: 4.5, salesperson: \"crass\" }, { sales: 2, salesperson: \"lago\" }];\n        var margin = { top: 30, right: 30, bottom: 40, left: 45 },\n            width = this.miniChartWidth - margin.left - margin.right,\n            height = this.miniChartHeight - margin.top - margin.bottom;\n\n        // set the ranges\n        var x = d3.scaleBand()\n            .range([0, width])\n            .padding(0.1);\n        var y = d3.scaleLinear()\n            .range([height, 0]);\n\n        // append the svg object to the body of the page\n        // append a 'group' element to 'svg'\n        // moves the 'group' element to the top left margin\n        var svg = d3.select(\"div.comparevisualizationbox\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .attr(\"class\", \"svgbox\" + layerScores.maxvalue)\n            .append(\"g\")\n            .attr(\"transform\",\n                \"translate(\" + margin.left + \",\" + margin.top + \")\");\n        x.domain(data.map(function (d) { return d.index; }));\n        y.domain([0, d3.max(data, function (d) { return d.score; })]);\n\n\n\n\n\n\n\n\n\n\n        // append the rectangles for the bar chart\n        svg.selectAll(\".bar\")\n            .data(data)\n            .enter().append(\"rect\")\n            .attr(\"class\", \"bar\")\n            .attr(\"x\", function (d) { return x(d.index); })\n            .attr(\"width\", x.bandwidth())\n            .attr(\"y\", function (d) { return y(d.score); })\n            .attr(\"height\", function (d) { return height - y(d.score); })\n            .attr(\"fill\", function (d, i) {\n                let color = d.score == layerScores.maxvalue ? \"green\" : \"#CDCDCD\";\n                // console.log(layerScores.maxindex, d.score, color)\n                return color\n            }).on(\"mouseover\", function () {\n                d3.select(this)\n                    .attr(\"fill\", \"#0062FF\");\n            })\n            .on(\"mouseout\", function (d, i) {\n                d3.select(this).attr(\"fill\", function () {\n                    let color = i == layerScores.maxindex ? \"green\" : \"#CDCDCD\";\n                    // console.log(layerScores.maxindex, d.score, color)\n                    return color\n                });\n            })\n\n\n        svg.selectAll(\"text\")\n            .data(data)\n            .enter()\n            .append(\"text\").text(function (d) {\n                return d.score.toFixed(0);\n            })\n            .attr(\"class\", \"boldtext\")\n            .attr(\"x\", function (d) {\n                return x(d.index) + 10;\n            })\n            .attr(\"y\", function (d) {\n                let maxVal = self.miniChartHeight - (margin.top + margin.bottom) - 5\n                return Math.min(maxVal, (y(d.score) + 14));\n            }).attr(\"font-family\", \"sans-serif\")\n            .attr(\"font-size\", \"9px\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"fill\", function (d, i) {\n                let color = d.score == layerScores.maxvalue ? \"white\" : \"black\";\n                // console.log(layerScores.maxindex, d.score, color)\n                return color\n            });\n\n\n        // add the y Axis\n        let yAxis = d3.axisRight(y)\n            .tickSize(this.miniChartWidth)\n        svg.append(\"g\")\n            .call(customYAxis);\n\n\n\n\n        // add the x Axis\n        var xAxis = d3.axisBottom(x)\n        svg.append(\"g\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(customXAxis);\n\n\n\n\n\n\n\n        // chart title\n        svg.append(\"text\")\n            .attr(\"x\", self.miniChartWidth / 2 - 20)\n            .attr(\"y\", -12)\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"boldtext mediumdesc\")\n            .text(function () {\n                // let textVal = \n                return (layerScores.model + \" [TOP: \" + layerScores.maxvalue + \"%] \").toUpperCase()\n            });\n\n        // xaxis label\n        svg.append(\"text\")\n            .attr(\"x\", self.miniChartWidth / 2 - (margin.left + margin.right) / 2)\n            .attr(\"y\", self.miniChartHeight - (margin.bottom + margin.bottom) + 40)\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"smalldesc\")\n            .text(\"layer (index)\");\n\n        // overallbest label\n        svg.append(\"text\")\n            .attr(\"x\", 0)\n            .attr(\"y\", 0 - 14)\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", function () {\n                return \"boldtext displaynone overallbest smalldesc topmodel\" + layerScores.maxvalue\n            })\n            .text(\"*BEST\");\n\n\n        //yaxis label\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", -5 - margin.left)\n            .attr(\"x\", 0 - (self.miniChartHeight / 2) + (margin.top + margin.bottom) / 2)\n            .attr(\"dy\", \"2em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"smalldesc\")\n            .text(\"search score\");\n\n\n        function customYAxis(g) {\n            g.call(yAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick:not(:first-of-type) line\").attr(\"stroke\", \"#777\").attr(\"stroke-dasharray\", \"2,2\").attr(\"class\", \" backstroke\" + layerScores.maxvalue);\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(xAxis);\n            g.select(\".domain\").remove();\n        }\n    }\n\n\n    componentDidMount() {\n        this.compareModels()\n\n    }\n\n    render() {\n        let selectedImagePath = process.env.PUBLIC_URL + \"/assets/semsearch/datasets/\" + this.props.data.dataset + \"/\" + this.props.data.selectedimage + \".jpg\"\n        let bestModelsList = this.state.bestModels.map((best, index) => {\n            // console.log(best)\n            return (\n                <div key={\"bestmodel\" + index} className=\"iblock mr5 greentext\"> {best.model.toUpperCase() + \"[\" + best.score + \"]\"}, </div>\n            )\n        })\n        return (\n            <div>\n                <div className=\"flex mb10\">\n                    <div className=\" mr10\">\n                        <img src={selectedImagePath} className=\"simiimage\" alt=\"\" />\n                    </div>\n                    <div className=\"flexfull\">\n                        For the current search query (image shown on the left),\n                        the charts below allows you to <strong>compare search score </strong> results obtained when we use layers\n                        from all <strong> {this.props.data.numModels} </strong> models. The <span className=\"greentext boldtext\"> green bar </span>\n                        highlights the layer(s) in a model with the best search score.\n                    </div>\n                </div>\n                {!this.state.loadingCompare &&\n                    <div className=\" mediumdesc mb10 boldtext\">\n                        Models with *BEST search score - {bestModelsList}.\n                    </div>\n                    // <div>{bestModelsList}</div>\n                }\n\n                <div className=\"comparevisualizationbox\">\n                    {this.state.loadingCompare &&\n                        <InlineLoading\n                            description=\"Comparing scores for all models ..\"\n                        >\n\n                        </InlineLoading>\n                    }\n                </div>\n\n                <br />\n                <br />\n\n\n            </div >\n\n        )\n    }\n\n}\n\nexport default CompareVisualization;","import React, { Component } from 'react'\nimport * as THREE from 'three'\nimport * as _ from 'lodash'\nimport * as d3 from 'd3'\nimport { InlineLoading } from 'carbon-components-react';\nimport * as TWEEN from '@tweenjs/tween.js'\nimport { loadJSONData, ColorArrayRGB } from \"../../components/helperfunctions/HelperFunctions\"\nimport \"./scene.css\"\n\n\n\nclass Scene extends Component {\n    constructor(props) {\n        super(props)\n\n        this.start = this.start.bind(this)\n        this.stop = this.stop.bind(this)\n        this.animate = this.animate.bind(this)\n\n\n        this.state = {\n            legend: [],\n            dataset: this.props.data.dataset,\n            model: this.props.data.model,\n            layer: this.props.data.layer,\n            layerindex: this.props.data.layerindex,\n            highlightedindex: 0,\n            mountingStuff: true,\n        }\n\n        this.setSelected = this.props.setselected\n\n\n    }\n    componentDidUpdate(prevProps, prevState) {\n        // console.log(\"showing both values\",prevProps.data, this.props.data)\n        // console.log(\"showing both values\")\n        // if (this.props.data.layer !== prevProps.data.layer ) {\n        //     console.log(\"things are different\")\n        //     // this.clearScene()\n        //     // console.log(\"clearing \", this.props.data)\n        //     // this.addPoints()\n        // }\n        if (this.props.data) {\n\n            if (this.props.data.dml !== prevProps.data.dml) {\n                // console.log(\"things have changed\", this.props.data)\n                this.setState({ dataset: this.props.data.dataset })\n                this.setState({ model: this.props.data.model })\n                this.setState({ layer: this.props.data.layer })\n                this.setState({ layerindex: this.props.data.layerindex })\n\n                if (this.props.data.selectedimage != prevProps.data.selectedimage) {\n                    this.highlightPoint(this.pointData[this.props.data.selectedimage])\n                }\n\n                // console.log(this.props.data.sele)\n            }\n\n        }\n\n        if (this.state.dataset !== prevState.dataset || this.state.model !== prevState.model || this.state.layer !== prevState.layer) {\n            this.loadData()\n        }\n\n    }\n\n\n\n    componentDidMount() {\n\n\n\n        const width = this.mount.clientWidth\n        const height = this.mount.clientHeight\n\n        this.fov = 15;\n        this.near = 0.001;\n        this.far = 90;\n        this.tweenDuration = 800\n\n        const scene = new THREE.Scene()\n        const camera = new THREE.PerspectiveCamera(\n            this.fov,\n            width / height,\n            this.near,\n            this.far\n        )\n        this.circle_sprite = new THREE.TextureLoader().load(\n            \"images/circle-sprite.png\",\n            function (texture) { },\n            function (xhr) { console.log((xhr.loaded / xhr.total * 100) + '% loaded'); },\n            function (xhr) { console.log('An error happened'); }\n        )\n        const renderer = new THREE.WebGLRenderer({ antialias: true })\n        const geometry = new THREE.BoxGeometry(1000, 1000, 1000)\n        const material = new THREE.MeshBasicMaterial({ color: '#433F81' })\n        const cube = new THREE.Mesh(geometry, material)\n\n        // camera.position.z = 4\n        // scene.add(cube)\n        renderer.setClearColor('#000000')\n        renderer.setSize(width, height)\n\n        this.scene = scene\n        this.camera = camera\n        this.renderer = renderer\n        this.material = material\n        this.cube = cube\n        this.width = width\n        this.height = height\n        this.pointScale = 1\n\n        window.addEventListener('resize', this.resizeHandler.bind(this))\n\n\n\n        this.mount.appendChild(this.renderer.domElement)\n        // console.log([this.getScaleFromZ(this.far), this.getScaleFromZ(this.near)])\n        this.zoom = d3.zoom().scaleExtent([this.getScaleFromZ(this.far), this.getScaleFromZ(this.near)])\n            .on('zoom', this.zoomHandler.bind(this));\n\n        this.view = d3.select(this.mount);\n        this.setUpZoom()\n\n\n        this.start()\n        // this.addPoints()\n        this.loadData()\n\n        this.raycaster = new THREE.Raycaster();\n        this.raycaster.params.Points.threshold = 1;\n\n        this.view.on(\"mousemove\", () => {\n            let [mouseX, mouseY] = d3.mouse(this.view.node());\n            let mouse_position = [mouseX, mouseY];\n            // console.log(mouse_position)\n            this.checkIntersects(mouse_position);\n        });\n\n        this.lastSeenIndex = 0;\n\n        this.view.on(\"click\", () => {\n            // console.log(\"clisk\", this.lastSeenIndex)\n            this.props.setselected(this.lastSeenIndex + \"\")\n            // this.clickTest()\n\n\n        });\n\n        this.view.on(\"mouseleave\", () => {\n            this.removeHighlights()\n            this.tooltipbox.style.display = \"none\"\n        });\n\n        this.hoverContainer = new THREE.Object3D()\n        this.scene.add(this.hoverContainer);\n\n        // setTimeout(() => {\n\n        // }, 3000);\n        this.setState({ mountingStuff: false })\n\n    }\n\n    clickTest() {\n        let models = [\"tinyimagenet\", \"cifar10\", \"iconic200\"]\n        let model = models[Math.round(Math.random() * models.length)] || \"cifar10\"\n        console.log(model)\n        this.setState({ dataset: model })\n    }\n\n    resizeHandler() {\n        this.width = window.innerWidth - 40;\n        // this.height = window.innerHeight;\n\n        this.renderer.setSize(this.width, this.height);\n        this.camera.aspect = this.width / this.height;\n        this.camera.updateProjectionMatrix();\n    }\n\n    highlightPoint(datum) {\n        this.removeHighlights();\n\n        let geometry = new THREE.Geometry();\n        geometry.vertices.push(new THREE.Vector3(datum.x * this.pointScale, datum.y * this.pointScale, 0));\n        let color = ColorArrayRGB()[this.legendMap.get(datum.class)]\n        color = \"rgb(\" + color[0] + \",\" + color[1] + \",\" + color[2] + \")\"\n        geometry.colors = [new THREE.Color(\"white\")];\n\n        let g2 = new THREE.Geometry();\n        g2.vertices.push(new THREE.Vector3(datum.x * this.pointScale, datum.y * this.pointScale, 0));\n        g2.colors = [new THREE.Color(color)];\n\n        let material = new THREE.PointsMaterial({\n            size: 30,\n            sizeAttenuation: false,\n            vertexColors: THREE.VertexColors,\n            map: this.circle_sprite,\n            transparent: true\n        });\n\n        let m2 = new THREE.PointsMaterial({\n            size: 25,\n            sizeAttenuation: false,\n            vertexColors: THREE.VertexColors,\n            map: this.circle_sprite,\n            transparent: true\n        });\n\n\n        let point = new THREE.Points(geometry, material);\n        let p2 = new THREE.Points(g2, m2);\n        // p2.geometry.colors = [new THREE.Color(\"#white\")];\n        point.add(p2)\n        this.hoverContainer.add(point);\n        // point.geometry.attributes.position.needsUpdate = true\n        // console.log(\"adding highlight\")\n    }\n\n\n\n    removeHighlights() {\n        this.hoverContainer.remove(...this.hoverContainer.children);\n    }\n\n    mouseToThree(mouseX, mouseY) {\n        return new THREE.Vector3(\n            mouseX / this.width * 2 - 1,\n            -(mouseY / this.height) * 2 + 1,\n            0\n        );\n    }\n\n    checkIntersects(mouse_position) {\n\n        let mouse_vector = this.mouseToThree(...mouse_position);\n        // console.log(mouse_position, mouse_vector)\n        this.raycaster.setFromCamera(mouse_vector, this.camera);\n        let intersects = this.raycaster.intersectObject(this.points);\n        if (intersects[0]) {\n            let sorted_intersects = this.sortIntersectsByDistanceToRay(intersects);\n            let intersect = sorted_intersects[0];\n            let index = intersect.index;\n\n            this.tooltipimg.src = process.env.PUBLIC_URL + \"/assets/semsearch/datasets/\" + this.state.dataset + \"/\" + index + \".jpg\"\n            // console.log(\"intersect\", index)\n            this.lastSeenIndex = index\n            let datum = this.pointData[index];\n            this.tooltip.innerHTML = (datum.class).toUpperCase()\n            let color = ColorArrayRGB()[this.legendMap.get(datum.class)]\n            color = \"rgb(\" + color[0] + \",\" + color[1] + \",\" + color[2] + \")\"\n            this.tooltip.style.backgroundColor = color\n            this.tooltipbox.style.display = \"block\"\n            this.tooltipbox.style.left = (mouse_position[0] + 19) + \"px\"\n            this.tooltipbox.style.top = (mouse_position[1] - 12) + \"px\"\n            this.highlightPoint(datum);\n            //   showTooltip(mouse_position, datum);\n            document.body.style.cursor = \"pointer\"\n        } else {\n            this.removeHighlights();\n            this.hideTooltip();\n            document.body.style.cursor = \"grab\"\n        }\n    }\n    hideTooltip() {\n        this.tooltipbox.style.display = \"none\"\n    }\n    sortIntersectsByDistanceToRay(intersects) {\n        return _.sortBy(intersects, \"distanceToRay\");\n    }\n\n    zoomHandler() {\n        let d3_transform = d3.event.transform\n        let scale = d3_transform.k;\n        let x = -(d3_transform.x - this.width / 2) / scale;\n        let y = (d3_transform.y - this.height / 2) / scale;\n        let z = this.getZFromScale(scale);\n        // console.log( this.width, d3_transform, x,y,z)\n        this.camera.position.set(x, y, z);\n        // console.log(\"On zoom \", x, y, z)\n        this.refs.camerazoom.innerHTML = \"x: \" + this.camera.position.x.toFixed(2) + \" y: \" + this.camera.position.y.toFixed(2) + \" z: \" + this.camera.position.z.toFixed(2)\n    }\n\n    getScaleFromZ(camera_z_position) {\n        let half_fov = this.fov / 2;\n        let half_fov_radians = this.toRadians(half_fov);\n        let half_fov_height = Math.tan(half_fov_radians) * camera_z_position;\n        let fov_height = half_fov_height * 2;\n        let scale = this.height / fov_height; // Divide visualization height by height derived from field of view\n        return scale;\n    }\n    toRadians(angle) {\n        return angle * (Math.PI / 180);\n    }\n\n    getZFromScale(scale) {\n        let half_fov = this.fov / 2;\n        let half_fov_radians = this.toRadians(half_fov);\n        let scale_height = this.height / scale;\n        let camera_z_position = scale_height / (2 * Math.tan(half_fov_radians));\n        return camera_z_position;\n    }\n\n\n    randomPosition(radius) {\n        var pt_angle = Math.random() * 2 * Math.PI;\n        var pt_radius_sq = Math.random() * radius * radius;\n        var pt_x = Math.sqrt(pt_radius_sq) * Math.cos(pt_angle);\n        var pt_y = Math.sqrt(pt_radius_sq) * Math.sin(pt_angle);\n        return [pt_x, pt_y];\n    }\n\n    setUpZoom() {\n        this.view.call(this.zoom);\n        let initial_scale = this.getScaleFromZ(this.far);\n        var initial_transform = d3.zoomIdentity.translate(this.width / 2, this.height / 2).scale(initial_scale);\n        // console.log(initial_transform)\n        this.zoom.transform(this.view, initial_transform);\n        // this.camera.position.setX(160);\n        // console.log(\"initial position\", this.camera.position)\n    }\n\n    zoomOutCamera() {\n\n        // this.setUpZoom()\n    }\n\n    clearScene() {\n        this.scene.remove.apply(this.scene, this.scene.children);\n    }\n\n    loadData() {\n        let umapPath = process.env.PUBLIC_URL + \"/assets/semsearch/umap/\" + this.state.dataset + \"/\" + this.state.model + \"/\" + this.state.layer + \".json\"\n        let loadedJSON = loadJSONData(umapPath)\n        // console.log(similarityPath)    \n        let self = this\n        loadedJSON.then(function (data) {\n            if (data) {\n                self.createPoints(data)\n            }\n        })\n    }\n\n    createPoints(data) {\n        // this.clearScene()\n        this.removeHighlights()\n        let pointsGeometry = new THREE.Geometry()\n        let pointsBufferGeometry = new THREE.BufferGeometry()\n        let colors = [];\n        let legend = new Map()\n        let legendArray = []\n        let vertices = []\n        let self = this\n\n\n\n        let xRange = { min: data[0].x, max: data[0].x }\n        let yRange = { min: data[0].y, max: data[0].y }\n        data.forEach(function (datum, i) {\n            let vert = new THREE.Vector3(datum.x, datum.y, 0);\n            vertices[i] = vert\n            // console.log(\"x\", datum.x.toFixed(3), \"y:\", datum.y.toFixed(3))\n            xRange.min = datum.x < xRange.min ? datum.x : xRange.min\n            xRange.max = datum.x > xRange.max ? datum.x : xRange.max\n            yRange.min = datum.y < yRange.min ? datum.y : yRange.min\n            yRange.max = datum.y > yRange.max ? datum.y : yRange.max\n        })\n\n        // console.log(\"x:\", xRange, \"y:\", yRange);\n\n\n        let numVertices = vertices.length\n        let positions = new Float32Array(numVertices * 3)\n        let offsets = new Float32Array(numVertices * 2)\n        let colorsBF = new Float32Array(numVertices * 3)\n        pointsBufferGeometry.addAttribute('position', new THREE.BufferAttribute(positions, 3))\n        pointsBufferGeometry.addAttribute('offset', new THREE.BufferAttribute(offsets, 2))\n        pointsBufferGeometry.addAttribute('color', new THREE.BufferAttribute(colorsBF, 3))\n\n        for (let i = 0, index = 0, l = numVertices; i < l; i++ , index += 3) {\n\n            positions[index] = data[i].x * this.pointScale\n            positions[index + 1] = data[i].y * this.pointScale\n            positions[index + 2] = 0\n\n\n            if (!legend.has(data[i].class)) {\n                legendArray.push({ class: data[i].class, index: legend.size })\n                legend.set(data[i].class, legend.size)\n            }\n\n            let color = ColorArrayRGB()[legend.get(data[i].class)]\n            colorsBF[index] = color[0] / 255\n            colorsBF[index + 1] = color[1] / 255\n            colorsBF[index + 2] = color[2] / 255\n        }\n\n        this.legendMap = legend\n        this.setState({ legend: legendArray })\n\n        if (this.pointData) {\n            this.zoomOutCamera()\n            // let numVertices = this.pointData.length\n            let position = this.points.geometry.attributes.position.array\n            let target = new Float32Array(numVertices * 3)\n            for (let i = 0, index = 0, l = numVertices; i < l; i++ , index += 3) {\n                target[index] = data[i].x * this.pointScale\n                target[index + 1] = data[i].y * this.pointScale\n                target[index + 2] = 0\n            }\n\n            let tween = new TWEEN.Tween(position).to(target, self.tweenDuration).easing(TWEEN.Easing.Linear.None)\n            tween.onUpdate(function () {\n                self.points.geometry.attributes.position = new THREE.BufferAttribute(position, 3)\n                self.points.geometry.attributes.position.needsUpdate = true // required after the first render\n            })\n            tween.start()\n            // console.log( this.points.geometry.attributes)\n            this.pointData = data\n        } else {\n            this.pointData = data\n            for (let datum of data) {\n                let vertex = new THREE.Vector3(datum.x * this.pointScale, datum.y * this.pointScale, 0);\n                pointsGeometry.vertices.push(vertex);\n                if (!legend.has(datum.class)) {\n                    legend.set(datum.class, legend.size)\n                    legendArray.push({ class: datum.class, index: legend.size })\n                }\n                let color = new THREE.Color(ColorArrayRGB()[legend.get(datum.class)]);\n                colors.push(color);\n            }\n\n            pointsGeometry.colors = colors;\n            let pointsMaterial = new THREE.PointsMaterial({\n                size: 10,\n                sizeAttenuation: false,\n                vertexColors: THREE.VertexColors,\n                map: this.circle_sprite,\n                transparent: true\n            });\n            this.points = new THREE.Points(pointsBufferGeometry, pointsMaterial);\n            this.scene.add(this.points);\n            this.scene.background = new THREE.Color(\"#CDCDCD\");\n\n        }\n\n    }\n\n    componentWillUnmount() {\n        this.stop()\n        this.mount.removeChild(this.renderer.domElement)\n        window.removeEventListener(\"resize\", this.resizeHandler.bind(this));\n    }\n\n    start() {\n        if (!this.frameId) {\n            this.frameId = requestAnimationFrame(this.animate)\n        }\n    }\n\n    stop() {\n        cancelAnimationFrame(this.frameId)\n    }\n\n    animate() {\n        // this.cube.rotation.x += 0.01\n        // this.cube.rotation.y += 0.01\n\n        this.renderScene()\n        this.frameId = window.requestAnimationFrame(this.animate)\n        TWEEN.update()\n    }\n\n    renderScene() {\n        this.renderer.render(this.scene, this.camera)\n    }\n\n    render() {\n        let legendList = this.state.legend.map((legend, index) => {\n            let color = ColorArrayRGB()[legend.index]\n            color = \"rgb(\" + color[0] + \",\" + color[1] + \",\" + color[2] + \")\"\n            return (\n                <div key={\"legend\" + index}>\n                    <div className=\"legendrow\">\n                        <div className=\"iblock legendcolorbox \" style={{ backgroundColor: color }}> </div>\n                        <div className=\"iblock boldtext legendtext ml10\"  >  {legend.class}  </div>\n                    </div>\n                </div>\n            )\n        });\n\n        return (\n            <div className=\" positionrelative\"\n                style={{ width: '100%', height: '400px' }}\n            >\n                {this.state.mountingStuff &&\n                    <div className=\"mb10\">\n                        <InlineLoading\n                            description=\"loading UMAP Visualization\"\n                        >\n\n                        </InlineLoading>\n                    </div>\n                }\n                <div className=\"positionrelative\">\n                    <div ref={(tooltipbox) => { this.tooltipbox = tooltipbox }} className=\"tooltip\">\n                        <div className=\"tooltiptitle\" ref={(tooltip) => { this.tooltip = tooltip }}> - </div>\n                        <img className=\"tooltipimg rad2\" ref={(tooltipimg) => { this.tooltipimg = tooltipimg }} src={\"/assets/semsearch/datasets/\" + this.state.dataset + \"/0.jpg\"} alt=\"\" />\n                    </div>\n                    <div className=\"chartdescription\">\n                        <div className=\"\"> Dataset: {this.state.dataset.toUpperCase()} </div>\n                        <div className=\"charttitle boldtext pt2 \"> Model: <span > {this.state.model.toUpperCase()} </span> Model </div>\n                        <div className=\"charttitle pt2\"> Layer: {this.state.layerindex}  [ {this.state.layer} ]   </div>\n                    </div>\n                    <div className=\"legendbox \">\n                        <div className=\"legendtitle boldtext \"> Categories </div>\n                        <div className=\"mt10\">\n                            {legendList}\n                        </div>\n                    </div>\n                    <div className=\"zoombox smalldesc p10\">\n                        <div className=\"iblock mr5 boldtext\"> Zoom: </div>\n                        <div className=\"iblock\" ref=\"camerazoom\"> </div>\n                    </div>\n                    <div\n                        style={{ width: '100%', height: '400px' }}\n                        ref={(mount) => { this.mount = mount }}\n                    />\n\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Scene","import React, { Component } from \"react\";\nimport { Modal, Toggle, Tooltip } from 'carbon-components-react';\n// import Notification20 from '@carbon/icons-react/lib/notification/20';\nimport \"./semanticex.css\"\nimport SemanticModalContent from \"../../components/modals/SemanticModal\"\nimport { registerGAEvent, greyColor, blueColor, abbreviateString, loadJSONData, makeFriendly, boundWidth, checkInView, animOptions, LeaderLine } from \"../../components/helperfunctions/HelperFunctions\"\nimport CompareVisualization from \"../../components/comparevisualization/CompareVisualization\"\nimport Scene from \"../../components/three/Scene\"\nimport * as _ from 'lodash'\n// import * as THREE from 'three'\n\n\nlet containerOffset = -80\nlet elementOffset = -385\nconst topTransitionDuration = 400;\n\nclass SemanticEx extends Component {\n    constructor(props) {\n        super(props);\n        const modelDetails = require('../../assets/semsearch/details.json');\n        this.modelDetails = modelDetails;\n        this.datasetdictionary = require('../../assets/semsearch/datasetdictionary.json');\n\n        // const initialSimilarityPath = \"../../assets/semsearch/similarity/\" + modelDetails[\"datasets\"][0].name + \"/\" + modelDetails[\"models\"][0].name + \"/\" + modelDetails[\"metrics\"][0] + \"/\" + modelDetails[\"models\"][0].layers[0] + \".json\"\n        const similarityArray = require('../../assets/semsearch/similarity/cifar100/vgg16/cosine/block1_conv1.json');\n        // require('../../assets/semsearch/similarity/cifar100/vgg16/cosine/block5_pool.json');\n        // console.log(similarityArray)\n\n        const defaultModel = 4\n\n        this.state = {\n            selecteddataset: 0,\n            selectedmodel: defaultModel, //modelDetails[\"models\"].length - 1,\n            selectedsimimage: 0,\n            hoversimimage: 0,\n            selectedlayer: modelDetails[\"models\"][defaultModel].layers.length - 1,\n            selectedmetric: 0,\n            similarityArray: similarityArray,\n            datasetArray: [],\n            datasetsList: modelDetails[\"datasets\"],\n            modelsList: modelDetails[\"models\"],\n            distanceMetricList: modelDetails[\"metrics\"],\n            showorientationmodal: !this.props.pageviewed,\n            showmodelconfig: false,\n            showumap: false,\n            showdatasetmodal: false,\n            showtopresults: false,\n            viewdatasetby: \"all\",\n            showadvanced: false,\n            topx: 15,\n            showcomparemodal: false\n        }\n        this.updateSimilarity()\n        this.loadDatasetList()\n\n        this.searchCount = 0;\n        this.lineHolder = []\n        this.lastclicked = \"dataset\"\n\n\n        this.keyFunction = this.keyFunction.bind(this);\n        this.scrollEndedHandler = this.scrollEndedHandler.bind(this)\n\n\n\n    }\n\n    scrollEndedHandler() {\n        window.clearTimeout(this.isScrolling);\n        let self = this\n        this.isScrolling = setTimeout(function () {\n            // console.log('Scrolling has stopped.');\n            self.drawLines()\n        }, 200);\n    }\n\n\n\n    resizeHandler() {\n        // this.drawLines()\n    }\n\n    getNextVisible(selectedModel) {\n        let modelVisible = checkInView(this.refs[\"modelscrollbox\"], this.refs[\"modelimg\" + selectedModel], true, containerOffset, elementOffset)\n        if (modelVisible) {\n            return selectedModel\n        } else {\n            let nextIndex = ((selectedModel * 1) + 1) % this.state.modelsList.length\n            return this.getNextVisible(nextIndex)\n        }\n    }\n\n    getNextVisibleLayer(selectedLayer) {\n        elementOffset = -1 * this.refs[\"modelscrollbox\"].offsetTop - 30\n        let layerVisible = checkInView(this.refs[\"layerscrollbox\"], this.refs[\"layerimg\" + selectedLayer], true, containerOffset, elementOffset)\n        if (layerVisible) {\n            console.log(selectedLayer, \" is available, returning \")\n            return selectedLayer\n        } else {\n            let nextIndex = ((selectedLayer * 1) + 1) % this.state.modelsList[this.state.selectedmodel].layers.length\n            console.log(selectedLayer, \"layer not available, trying \", nextIndex)\n            return this.getNextVisibleLayer(nextIndex)\n        }\n    }\n\n    drawLines(e) {\n        if (this.state.showmodelconfig) {\n            this.removeLines()\n            let self = this;\n            let layers = this.state.modelsList[this.state.selectedmodel].layers\n\n\n            elementOffset = -1 * self.refs[\"modelscrollbox\"].offsetTop - 30\n            // console.log(\"offsettop\", self.refs[\"modelscrollbox\"].offsetTop)\n\n            // let visibleModel = this.getNextVisible(this.state.selectedmodel)\n            // if (visibleModel != this.state.selectedmodel) {\n            //     this.setState({ selectedmodel: visibleModel + \"\" })\n            // }\n\n            // let visibleLayer = this.getNextVisibleLayer(this.state.selectedlayer)\n            // if (visibleLayer != this.state.selectedlayer) {\n            //     this.setState({ selectedlayer: visibleLayer + \"\" })\n            // }\n\n            let modelVisible = checkInView(self.refs[\"modelscrollbox\"], self.refs[\"modelimg\" + this.state.selectedmodel], true, containerOffset, elementOffset)\n            // console.log(\"Next visible is \", this.getNextVisible(this.state.selectedmodel))\n            let maxLineWidth = 3.5\n            let minLineWidth = 1.5\n            let incs = (maxLineWidth - minLineWidth) / layers.length\n\n\n            layers.forEach(function (each, i) {\n\n                let layerVisible = checkInView(self.refs[\"layerscrollbox\"], self.refs[\"layerimg\" + i], true, containerOffset, elementOffset)\n                if (layerVisible && modelVisible) {\n                    // console.log(\"we drawing to\", i)\n\n                    // console.log(i, self.state.selectedlayer)\n\n                    let line = new LeaderLine(self.refs[\"modelimg\" + self.state.selectedmodel], self.refs[\"layerimg\" + i], {\n                        color: self.state.selectedlayer == (i + \"\") ? blueColor : greyColor,\n                        startPlug: 'disc',\n                        endPlug: 'disc',\n                        startPlugColor: blueColor,\n                        path: \"fluid\",\n                        size: Math.min(minLineWidth + i * incs, maxLineWidth),\n                        hide: true,\n                        startSocket: 'bottom',\n                        endSocket: self.state.selectedlayer == (i + \"\") ? \"top\" : 'left',\n                        endPlugSize: maxLineWidth / Math.min(minLineWidth + i * incs, maxLineWidth),\n\n                    });\n                    document.querySelector('.leader-line').style.zIndex = -100\n                    animOptions.duration = 800\n                    line.show(\"draw\", animOptions)\n                    self.lineHolder.push({ line: line, index: i })\n                }\n            })\n        }\n\n    }\n    removeLines(e) {\n        this.lineHolder.forEach(function (each) {\n            each.line.remove()\n        })\n        this.lineHolder = []\n    }\n    recolorLines(e) {\n        let self = this\n        // let visibleLayer = this.getNextVisibleLayer(this.state.selectedlayer)\n        // if (visibleLayer != this.state.selectedlayer) {\n        //     this.setState({ selectedlayer: visibleLayer + \"\" })\n        // }\n        if (this.LayerScrollTop != this.refs[\"layerscrollbox\"].scrollTop) {\n            this.LayerScrollTop = this.refs[\"layerscrollbox\"].scrollTop\n            this.drawLines()\n        } else {\n            this.lineHolder.forEach(function (each) {\n                if (each.index == self.state.selectedlayer) {\n                    each.line.hide(\"none\")\n                    each.line.color = blueColor\n                    each.line.show(\"draw\", animOptions)\n                    each.line.endSocket = \"top\"\n                } else {\n                    each.line.color = greyColor\n                    each.line.endSocket = \"left\"\n                }\n            })\n        }\n    }\n\n    getNextVal(newVal, maxVal) {\n        if (newVal >= 0) {\n            return newVal % maxVal\n        } else {\n            return (maxVal - Math.abs(newVal))\n        }\n\n    }\n    cycleLayerModel(val) {\n        if (this.lastclicked == \"model\") {\n            let newState = this.getNextVal((this.state.selectedmodel * 1 + val), this.state.modelsList.length);// Math.max((this.state.selectedmodel*1 + val) % this.state.modelsList.length, 0) \n            // console.log(newState)\n            if (!(isNaN(newState))) {\n                this.setState({ selectedmodel: newState })\n            }\n\n        }\n        else if (this.lastclicked == \"dataset\") {\n            let newState = this.getNextVal((this.state.selecteddataset * 1 + val), this.state.datasetsList.length)\n            if (!(isNaN(newState))) {\n                this.setState({ selecteddataset: newState })\n            }\n\n        } else if (this.lastclicked == \"layer\") {\n            let newState = this.getNextVal((this.state.selectedlayer * 1 + val), this.state.modelsList[this.state.selectedmodel].layers.length)\n            if (!(isNaN(newState))) {\n                this.setState({ selectedlayer: newState })\n            }\n\n        } else if (this.lastclicked == \"neuron\") {\n\n            let numNeurons = (this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name].length)\n            let newState = this.getNextVal((this.state.selectedneuron * 1 + val), numNeurons)\n            // console.log(this.state.selectedneuron,newState,  val, numNeurons)\n            if (!(isNaN(newState))) {\n                this.setState({ selectedneuron: newState })\n            }\n\n        }\n    }\n\n    keyFunction(event) {\n        if (this.state.showmodelconfig) {\n            if (event.keyCode === 37) {\n                this.cycleLayerModel(-1)\n            }\n            else if (event.keyCode === 39) {\n                this.cycleLayerModel(1)\n            }\n        }\n    }\n\n    componentDidMount() {\n        document.title = \"ConvNet Playground | Semantic Search Explorer\";\n        this.LayerScrollTop = 0\n        window.addEventListener('resize', this.scrollEndedHandler)\n        document.addEventListener(\"keydown\", this.keyFunction, false);\n        this.refs[\"layerscrollbox\"].addEventListener(\"scroll\", this.scrollEndedHandler, false)\n        this.refs[\"modelscrollbox\"].addEventListener(\"scroll\", this.scrollEndedHandler, false)\n\n\n        //timer on when component mounted\n        this.componentLoadedTime = (new Date()).getTime()\n    }\n\n\n    componentWillUnmount() {\n        this.removeLines();\n        document.removeEventListener(\"keydown\", this.keyFunction);\n        window.removeEventListener('resize', this.scrollEndedHandler)\n\n        this.refs[\"layerscrollbox\"].removeEventListener(\"scroll\", this.scrollEndedHandler, false)\n        this.refs[\"modelscrollbox\"].removeEventListener(\"scroll\", this.scrollEndedHandler, false)\n\n        // if (this.timeout) {\n        //     clearTimeout(this.timeout)\n        // }\n    }\n\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.selectedmodel !== prevState.selectedmodel || this.state.selectedmetric !== prevState.selectedmetric || this.state.selectedlayer !== prevState.selectedlayer || this.state.selecteddataset !== prevState.selecteddataset) {\n            this.updateSimilarity()\n            this.showTopResults()\n            this.searchCount++\n\n        }\n        if (this.state.selectedmodel !== prevState.selectedmodel) {\n            this.drawLines()\n        }\n        if (this.state.selectedlayer !== prevState.selectedlayer) {\n            this.recolorLines()\n        }\n        if (this.state.showmodelconfig != prevState.showmodelconfig) {\n            let self = this\n            if (this.state.showmodelconfig) {\n                this.drawLines()\n                // console.log(this.state.selectedlayer, this.refs.layerscrollbox.clientHeight)\n                if (this.state.selectedlayer == \"7\") {\n                    this.refs.layerscrollbox.scrollTo({\n                        top: 100,\n                        left: 0,\n                        behavior: 'smooth'\n                    });\n                }\n            } else {\n                this.removeLines()\n\n            }\n        }\n    }\n\n    clickDatasetImage(e) {\n        registerGAEvent(\"semanticsearch\", \"datasetchange\", this.state.datasetsList[e.target.getAttribute(\"indexvalue\")].name, this.componentLoadedTime)\n        this.setState({ selecteddataset: e.target.getAttribute(\"indexvalue\") })\n        // this.setState({ selectedmodel: 0 })\n        this.lastclicked = \"dataset\"\n    }\n\n    clickModelImage(e) {\n        registerGAEvent(\"semanticsearch\", \"modelchange\", this.state.modelsList[e.target.getAttribute(\"indexvalue\")].name, this.componentLoadedTime)\n        this.setState({ selectedmodel: e.target.getAttribute(\"indexvalue\") })\n        // this.setState({ selectedlayer: 0 })\n        this.lastclicked = \"model\"\n    }\n\n    clickLayerImage(e) {\n        registerGAEvent(\"semanticsearch\", \"layerchange\", this.state.datasetsList[this.state.selecteddataset].name + \",\" + this.state.modelsList[this.state.selectedmodel].layers[e.target.getAttribute(\"indexvalue\")].name, this.componentLoadedTime)\n        this.setState({ selectedlayer: e.target.getAttribute(\"indexvalue\") })\n        this.lastclicked = \"layer\"\n    }\n\n    clickMetricImage(e) {\n        registerGAEvent(\"semanticsearch\", \"metricchange\", this.state.distanceMetricList[e.target.getAttribute(\"indexvalue\")], this.componentLoadedTime)\n        this.setState({ selectedmetric: e.target.getAttribute(\"indexvalue\") })\n    }\n\n    clickSimilarImage(e) {\n        registerGAEvent(\"semanticsearch\", \"searchquery\", this.state.datasetsList[this.state.selecteddataset].name + \",\" + e.target.getAttribute(\"indexvalue\"), this.componentLoadedTime)\n        this.setSelectedImage(e.target.getAttribute(\"indexvalue\"))\n    }\n\n    hoverSimilarImage(e) {\n        let val = e.target.getAttribute(\"indexvalue\")\n        if (val != this.state.hoversimimage) {\n            this.setState({ hoversimimage: val })\n            // this.showTopResults()\n        }\n    }\n    setSelectedImage(val) {\n        // console.log(val);\n\n        if (val != this.state.selectedsimimage) {\n            this.setState({ selectedsimimage: val }, () => {\n                // console.log(this.incorrectResults)\n                this.incorrectResults.forEach(each => {\n                    // console.log(this.refs[\"outersimbar\" + each[0]])\n                    this.refs[\"outersimbar\" + each[0]].className = \"outersimbarorange\"\n                });\n            })\n            this.showTopResults()\n        }\n        this.searchCount++\n\n\n    }\n\n    toggleSemanticModal(e) {\n\n        registerGAEvent(\"semanticsearch\", \"semanticmodal\", this.state.showorientationmodal ? \"close\" : \"open\", this.componentLoadedTime)\n        this.setState({ showorientationmodal: !(this.state.showorientationmodal) })\n\n\n    }\n\n\n    toggleModelConfig(e) {\n        this.setState({ showmodelconfig: !(this.state.showmodelconfig) })\n\n    }\n\n    toggleUMAPView(e) {\n        registerGAEvent(\"semanticsearch\", \"umapviewe\", this.state.showumap ? \"close\" : \"open\", this.componentLoadedTime)\n        this.setState({ showumap: !(this.state.showumap) })\n    }\n\n    toggleTopX(e) {\n        this.setState({ showtopresults: !(this.state.showtopresults) })\n    }\n\n    toggleDatasetModal(e) {\n        this.setState({ showdatasetmodal: !(this.state.showdatasetmodal) })\n    }\n\n    toggleShowCompare(e) {\n        registerGAEvent(\"semanticsearch\", \"comparemodels\", this.state.showcomparemodal ? \"off\" : \"on\", this.componentLoadedTime)\n        this.setState({ showcomparemodal: !(this.state.showcomparemodal) })\n    }\n\n    toggleViewDatasetBy(e) {\n        this.setState({ viewdatasetby: e.target.getAttribute(\"viewby\") })\n    }\n    toggleAdvancedOptions(e) {\n        registerGAEvent(\"semanticsearch\", \"advancedoptions\", this.state.showadvanced ? \"off\" : \"on\", this.componentLoadedTime)\n        this.setState({ showmodelconfig: !(this.state.showadvanced) })\n        this.setState({ showadvanced: !(this.state.showadvanced) })\n    }\n\n    showTopResults() {\n        let self = this\n        // this.setState({ showtopresults: true })\n        this.setState({ showtopresults: true })\n        this.refs[\"topresultsbox\"].style.opacity = 0.65;\n\n        this.refs[\"glowbar\"].classList.add('notransition');\n        this.refs[\"glowbar\"].style.width = \"0%\";\n\n        setTimeout(() => {\n            self.refs[\"glowbar\"].classList.remove('notransition');\n            self.refs[\"glowbar\"].style.width = \"100%\";\n\n        }, 150);\n\n        setTimeout(() => {\n            self.refs[\"topresultsbox\"].style.opacity = 1;\n        }, topTransitionDuration);\n\n\n    }\n\n    updateSimilarity() {\n\n        let similarityPath = process.env.PUBLIC_URL + \"/assets/semsearch/similarity/\" + this.state.datasetsList[this.state.selecteddataset].name + \"/\" + this.state.modelsList[this.state.selectedmodel].name + \"/\" + this.state.distanceMetricList[this.state.selectedmetric] + \"/\" + this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name + \".json\"\n        let loadedJSON = loadJSONData(similarityPath)\n        // console.log(similarityPath)    \n        let self = this\n        loadedJSON.then(function (data) {\n            if (data) {\n                self.setState({ similarityArray: data })\n\n            }\n        })\n\n    }\n\n    loadDatasetList() {\n\n        let similarityPath = process.env.PUBLIC_URL + \"/assets/semsearch/similarity/\" + this.state.datasetsList[this.state.selecteddataset].name + \"/\" + this.state.modelsList[this.state.selectedmodel].name + \"/\" + this.state.distanceMetricList[this.state.selectedmetric] + \"/\" + this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name + \".json\"\n        let loadedJSON = loadJSONData(similarityPath)\n        let self = this\n        loadedJSON.then(function (data) {\n            if (data) {\n                let dArray = _.shuffle(data[\"0\"])\n                self.setState({ datasetArray: dArray })\n            }\n        })\n\n    }\n\n\n\n\n\n\n    render() {\n        let self = this\n        let datasetImageList = this.state.datasetsList.map((dsdata, index) => {\n            let iconPath = process.env.PUBLIC_URL + \"/assets/semsearch/images/\" + dsdata.icon\n            // console.log(dsdata)\n            return (\n                <div key={dsdata.name + \"fullbox\" + index} className=\"iblock datasetfullbox clickable mb10\">\n                    <div className=\"datasettitles\"> {dsdata.name.toUpperCase()}</div>\n                    <div className=\"smalldesc pb5\">{dsdata.size} images </div>\n                    <img onClick={this.clickDatasetImage.bind(this)} src={iconPath} alt=\"\" className={\"datasetbox rad2 \" + (this.state.selecteddataset == index ? \"active\" : \"\")} indexvalue={index} />\n                </div>\n            )\n        });\n\n\n        let modelImageList = this.state.modelsList.map((mdata, index) => {\n            let selectedModel = this.state.modelsList[index].name\n            let selectedlayer = this.state.modelsList[index].layers[this.state.modelsList[index].layers.length - 1].name\n\n            let imagePath = process.env.PUBLIC_URL + \"/assets/models/\" + selectedModel + \"/\" + selectedlayer + \"/0.jpg\"\n            // console.log(imagePath)\n\n            return (\n                <div ref={\"modelimgbox\" + index} key={mdata.name + \"fullbox\" + index} className=\"iblock datasetfullbox clickable mb10 \">\n                    <div className=\"datasettitles\"> {abbreviateString(mdata.name.toUpperCase(), 11)}</div>\n                    <div className=\"smalldesc pb5\">{makeFriendly(mdata[\"modelparameters\"])} params. </div>\n                    <img ref={\"modelimg\" + index} onClick={this.clickModelImage.bind(this)} src={imagePath} alt=\"\" className={\"datasetbox rad2 \" + (this.state.selectedmodel == index ? \"active\" : \"\")} indexvalue={index} />\n                </div>\n            )\n        });\n\n        let layerImageList = this.state.modelsList[this.state.selectedmodel].layers.map((ldata, index) => {\n            let selectedModel = this.state.modelsList[this.state.selectedmodel].name\n            let selectedlayer = this.state.modelsList[this.state.selectedmodel].layers[index].name\n            // let neuronList = this.layerList[selectedModel] [selectedlayer]\n            let imagePath = process.env.PUBLIC_URL + \"/assets/models/\" + selectedModel + \"/\" + selectedlayer + \"/0.jpg\"\n\n            return (\n                <div key={ldata + \"fullbox\" + index} className=\"iblock datasetfullbox clickable mb10 \">\n                    <div className=\"datasettitles\"> {\"layer \" + ldata.layer_index} </div>\n                    {/* {abbreviateString(ldata.name, 11).toLowerCase()}  */}\n                    <div className=\"smalldesc pb5\"> {makeFriendly(ldata.modelparameters)} params</div>\n                    <img ref={\"layerimg\" + index} onClick={this.clickLayerImage.bind(this)} src={imagePath} alt=\"\" className={\"datasetbox rad2 \" + (this.state.selectedlayer == index ? \"active\" : \"\")} indexvalue={index} />\n                </div>\n            )\n        });\n\n        let metricImageList = this.state.distanceMetricList.map((metric, index) => {\n            return (\n                <div key={metric + \"fullbox\" + index} className=\" positionrelative iblock datasetfullbox clickable mb10 \">\n                    <div className=\"datasettitles\"> {abbreviateString(metric, 11).toUpperCase()} </div>\n                    <div className=\"smalldesc pb5\"> distance</div>\n                    <div className=\"metrictitle positionabsolute\"> {abbreviateString(metric, 3).toUpperCase()}</div>\n                    <img onClick={this.clickMetricImage.bind(this)} src={require(\"../../images/bgwhite.png\")} alt=\"\" className={\"datasetbox rad2 \" + (this.state.selectedmetric == index ? \"active\" : \"\")} indexvalue={index} />\n                </div>\n            )\n        });\n\n        // console.log(this.state.similarityArray[this.state.selectedsimimage]) \n        let datasetClasses = this.datasetdictionary[\"classlist\"][this.state.datasetsList[this.state.selecteddataset].name]\n\n        let datasetClassImagesList = []\n        let co = datasetClasses.map((className, index) => {\n            let classcon = this.datasetdictionary[\"classes\"][this.state.datasetsList[this.state.selecteddataset].name]\n            let clist = classcon[className].map((classval, index) => {\n                let imagePath = process.env.PUBLIC_URL + \"/assets/semsearch/datasets/\" + this.state.datasetsList[this.state.selecteddataset].name + \"/\" + classval + \".jpg\"\n                return (\n                    <div key={classval + \"winper\"} className=\"iblock similarityfullbox mr5 mb5 positionrelative\">\n                        <img key={classval + \"image\"} onMouseOver={this.hoverSimilarImage.bind(this)} onClick={this.clickSimilarImage.bind(this)} src={imagePath} alt=\"\" className={\"simiimage clickable rad2 \" + (this.state.selectedsimimage == classval ? \"active\" : \"\")} indexvalue={classval} />\n                    </div>\n                )\n            });\n            let header =\n                <div key={\"header\" + className} className=\"iblock mr5 categorymain  mb5 \">\n                    <div>\n                        <div className=\" boldtext categorytitle\"> {className.toUpperCase()} </div>\n                        <img src={require(\"../../images/bgwhite.png\")} alt=\"\" className={\"categorybox rad2 \"} indexvalue={index} />\n                    </div>\n\n                </div>\n\n            datasetClassImagesList.push(header)\n            datasetClassImagesList.push(clist)\n        });\n\n        let similarImagesList = this.state.similarityArray[this.state.selectedsimimage].map((alldata, index) => {\n            let imagePath = process.env.PUBLIC_URL + \"/assets/semsearch/datasets/\" + this.state.datasetsList[this.state.selecteddataset].name + \"/\" + alldata[0] + \".jpg\"\n            // console.log(imagePath)\n            let similarityScore = (alldata[1] * 1).toFixed(3)\n            let returnValue = (\n                <div key={alldata[0] + \"winper\"} className=\"iblock similarityfullbox mr5 mb5 positionrelative\">\n                    <div className=\"smalldesc mb5\">dst: {makeFriendly((1 * similarityScore).toFixed(2))} </div>\n                    <img key={alldata[0] + \"image\" + alldata[0]} onMouseOver={this.hoverSimilarImage.bind(this)} onClick={this.clickSimilarImage.bind(this)} src={imagePath} alt=\"\" className={\"simiimage clickable rad2 \"} indexvalue={alldata[0]} />\n                    <div className=\"outersimbar\" ref={\"outersimbar\" + alldata[0]}>\n                        <div className=\"innersimbar\" style={{ width: (boundWidth(similarityScore) * 100) + \"%\" }}></div>\n                    </div>\n                    <div className=\"similarityscorebox\">{makeFriendly(similarityScore)} </div>\n                    {/* <div>{ \"w:\" + boundWidth(similarityScore)*100  }</div> */}\n                </div>\n            )\n            return (returnValue)\n        });\n\n        let simArr = this.state.similarityArray[this.state.selectedsimimage].slice(1, this.state.topx + 1)\n        let allDictionary = this.datasetdictionary.dictionary[this.state.datasetsList[this.state.selecteddataset].name]\n        let selectedCat = allDictionary[this.state.selectedsimimage]\n        // console.log(simar.slice(1, this.state.topx + 1))\n        // console.log(this.state.selectedsimimage)\n        let simCount = 0\n        let modelScore = 0\n        let totalScore = 0\n        this.incorrectResults = []\n        for (var i in simArr) {\n\n            if (selectedCat == allDictionary[simArr[i][0]]) {\n                simCount++\n                modelScore += (this.state.topx - i) / this.state.topx\n            } else {\n\n                this.incorrectResults.push(simArr[i])\n            }\n            totalScore += (this.state.topx - i) / this.state.topx\n        }\n\n\n        // let outBars = document.getElementsByClassName(\"outersimbar\")\n        // for (let i = 0; i < outBars.length; i++) {\n        //     if (incorrectResults.includes(outBars[i].id)) {\n        //         console.log(outBars[i].id)\n        //         outBars[i].className = \"\"\n        //         outBars[i].style.height = \"10px\"\n        //     }\n\n        // }\n\n\n        let datasetimagesList = this.state.datasetArray.map((alldata, index) => {\n            let imagePath = process.env.PUBLIC_URL + \"/assets/semsearch/datasets/\" + this.state.datasetsList[this.state.selecteddataset].name + \"/\" + alldata[0] + \".jpg\"\n            // let similarityScore = (alldata[1] * 1).toFixed(3) \n            let returnValue = (\n                <div key={alldata[0] + \"winper\"} className=\"iblock similarityfullbox mr5 mb5 positionrelative\">\n                    <img key={alldata[0] + \"image\" + alldata[0]} onClick={this.clickSimilarImage.bind(this)} src={imagePath} alt=\"\" className={\"simiimage clickable rad2 \" + (this.state.selectedsimimage == alldata[0] ? \"active\" : \"\")} indexvalue={alldata[0]} />\n                </div>\n            )\n            return (returnValue)\n        });\n\n        // datasetimagesList = _.shuffle(datasetimagesList)\n        // alert(datasetimagesList.length)\n\n        // let datasetSimpleimagesList = this.state.datasetArray.map((alldata, index) => {\n        //     let imagePath = process.env.PUBLIC_URL + \"/assets/semsearch/datasets/\" + this.state.datasetsList[this.state.selecteddataset].name + \"/\" + alldata[0] + \".jpg\"\n        //     // let similarityScore = (alldata[1] * 1).toFixed(3) \n        //     let returnValue = (\n        //         <div key={alldata[0] + \"winper\"} className=\"iblock similarityfullbox mr5 mb5 positionrelative\">\n        //             <img key={alldata[0] + \"image\" + alldata[0]} src={imagePath} alt=\"\" className={\"simiimage  rad2 \" + (this.state.selectedsimimage == alldata[0] ? \"active\" : \"\")} indexvalue={alldata[0]} />\n        //         </div>\n        //     )\n        //     return (returnValue)\n        // });\n\n\n\n        let selectedImagePath = process.env.PUBLIC_URL + \"/assets/semsearch/datasets/\" + this.state.datasetsList[this.state.selecteddataset].name + \"/\" + this.state.selectedsimimage + \".jpg\"\n        // process.env.PUBLIC_URL + \"/assets/semsearch/datasets/cifar100/train/\" + this.state.selectedsimimage + \".jpg\"\n        return (\n            <div className=\"mainsemanticdiv\">\n\n\n                {(this.state.showorientationmodal) && <Modal className=\"orientationmodal\"\n                    open={true}\n                    size=\"lg\"\n                    aria-label=\"Semantic Search Modal\"\n                    // style={{maxWidth: '1600px', width: '100%'}}\n                    passiveModal={false}\n                    primaryButtonText=\"Get Started\"\n                    // secondaryButtonText=\"\"\n                    modalHeading=\"Semantic Search\"\n                    modalLabel=\"ConvNet Playground\"\n                    onRequestSubmit={this.toggleSemanticModal.bind(this)}\n                    onRequestClose={this.toggleSemanticModal.bind(this)}\n                >\n                    <SemanticModalContent></SemanticModalContent>\n\n                </Modal>}\n\n                {(this.state.showcomparemodal) && <Modal className=\"comparemodal\"\n                    open={true}\n                    size=\"lg\"\n                    aria-label=\"Compare Models Modal\"\n                    // style={{maxWidth: '1600px', width: '100%'}}\n                    passiveModal={true}\n                    primaryButtonText=\"Get Started\"\n                    secondaryButtonText=\"Close\"\n                    modalHeading=\"Compare models\"\n                    modalLabel=\"Compare models\"\n                    onRequestSubmit={this.toggleShowCompare.bind(this)}\n                    onRequestClose={this.toggleShowCompare.bind(this)}\n                >\n                    {/* <div className=\"mb10\">\n                        Charts of search score results for the current image using all\n                         models and layers.\n                   </div> */}\n                    <CompareVisualization\n                        data={{\n                            metric: this.state.distanceMetricList[this.state.selectedmetric],\n                            selectedimage: this.state.selectedsimimage,\n                            numLayers: 8,\n                            numModels: this.state.modelsList.length,\n                            dataset: this.state.datasetsList[this.state.selecteddataset].name,\n                            topx: this.state.topx,\n                            chartWidth: 250,\n                            chartHeight: 220,\n                            datasetdictionary: this.datasetdictionary,\n                            modelDetails: this.modelDetails\n                        }}\n                    />\n\n                </Modal>}\n\n                {(this.state.showdatasetmodal) && <Modal className=\"datasetmodal\"\n                    open={true}\n                    size=\"lg\"\n                    aria-label=\"Dataset Modal\"\n                    // style={{maxWidth: '1600px', width: '100%'}}\n                    passiveModal={true}\n                    primaryButtonText=\"Get Started\"\n                    // secondaryButtonText = \"Do not show this again\"\n                    modalHeading={this.state.datasetsList[this.state.selecteddataset].name.toUpperCase()}\n                    modalLabel=\"Dataset details\"\n                    onRequestSubmit={this.toggleDatasetModal.bind(this)}\n                    onRequestClose={this.toggleDatasetModal.bind(this)}\n                >\n                    <div className=\" mb10\">{this.state.datasetsList[this.state.selecteddataset].description}  </div>\n                    {datasetClassImagesList}\n\n                </Modal>}\n\n                <div className=\" flex   \">\n                    <div className=\"iblock sectiontitle flexfull pt4 \"> Image Similarity Search </div>\n                    <div className=\"flex  \">\n                        <div onClick={this.toggleSemanticModal.bind(this)} className=\"iblock floatright  clickable showmore\"> ? More Info  </div>\n                    </div>\n                </div>\n\n                {/* <div className=\"flex mt10\">\n                    <div className=\"flex4 mr10 mynotif lightbluehightlight  p20\">\n                        <div className=\"boldtext mb10\"> Semantic Search</div>\n                        <div className=\"lh10 maxh16\">{semsearchIntro}</div>\n                    </div>\n                    <div className=\"flex6  mynotif lightbluehightlight p20\">\n                        <div className=\"boldtext mb10\"> Model architectures and Layers</div>\n                        <div className=\"lh10 maxh16\">{convnetLayer}</div>\n                    </div>\n\n                </div> */}\n\n                <div className=\"flex \">\n                    <div className=\"flex5 \">\n\n                        <div className=\"mynotif h100 lh10 pl  instructions lightbluehightlight maxh16 mr10\">\n                            <div className=\"boldtext pb5\"> Welcome!</div>\n                            This demo allows you to perform <strong> semantic image search </strong> using convolutional neural networks\n                            <span className=\"\"> [\n                             <strong> {this.state.modelsList[this.state.selectedmodel].name.toUpperCase()}   </strong>\n                                {/* <strong>  {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index}  </strong> */}\n                                {/* <strong> DISTANCE METRIC: </strong>   {this.state.distanceMetricList[this.state.selectedmetric].toUpperCase()} ] */}\n                                ]</span>.\nWhen you select an image (by clicking it), a neural network <span className=\"italics\"> looks </span> at the content of all images in our dataset\n                            and shows you the  <strong> top {this.state.topx} </strong> most similar images to the selected image.\n                          </div>\n                    </div>\n\n                    <div className=\"flex5\">\n                        <div className=\"mynotif lh10  h100  instructions lightbluehightlight maxh16\">\n                            <div className=\"boldtext pb5 advancedoptionsbox\"> Advanced Options</div>\n                            <div className=\"advancedgreyborder rad2 iblock pr10 pl10 \">\n                                {/* <div className=\"mr10 pt10\">Advanced options </div> */}\n                                <div className=\"boldtext mr20\">\n                                    <Toggle\n                                        id=\"advancedoptionstoggle\"\n                                        className='smalldesc boldtext mr10'\n                                        labelA='Off'\n                                        labelB='On'\n                                        // onChange action('onChange'),\n                                        onToggle={this.toggleAdvancedOptions.bind(this)}\n                                    ></Toggle>\n                                </div>\n\n                            </div>\n                            Interested in modifying search configurations (try different datasets, models, layers and distance metrics)\n                            or a UMAP visualization of the features extracted by each layer? Turn on advanced options.\n\n\n\n                        </div>\n\n                    </div>\n\n                </div>\n\n\n\n\n                <div className={\" \" + (this.state.showadvanced ? \"\" : \" displaynone\")}>\n\n                    {/* config panel and content */}\n                    <div onClick={this.toggleModelConfig.bind(this)} className=\"unselectable mt10 p10 clickable  flex greymoreinfo\">\n                        <div className=\"iblock flexfull minwidth485\"> <strong> {!this.state.showmodelconfig && <span>&#x25BC;  </span>} {this.state.showmodelconfig && <span>&#x25B2;  </span>} </strong> Search Configuration </div>\n                        <div className=\"iblock   \">\n                            <div className=\"iblock mr5\"> <span className=\"boldtext\"> {this.state.datasetsList[this.state.selecteddataset].name.toUpperCase()}</span></div>\n                            <div className=\"iblock\">\n                                <div className=\"smalldesc\"> DATASET </div>\n                            </div>\n                        </div>\n\n                    </div>\n\n                    {<div style={{ zIndex: 500 }} className={\"flex modelconfigdiv p10 \" + (this.state.showmodelconfig ? \"\" : \" displaynone\")} >\n                        <div className=\"flex2 mr10\">\n                            <div className=\" pb10 sectiontitle\" >\n                                <div className=\"iblock\">\n                                    Select Dataset\n                                </div>\n                                <div className=\"iblock\">\n                                    {/* <Tooltip\n                                        className=\"border\"\n                                        triggerText=\"\"\n                                    >\n                                        <div className=\"wscore\">\n                                            This is the percentage of returned results that belong to the same category\n                                                        as the selected image (weighted by position in the result list). In this case, <strong>{simCount} / {this.state.topx} results </strong>  are in same category\n                                                        </div>\n\n                                    </Tooltip> */}\n                                </div>\n\n\n                            </div>\n                            <div className=\"horrule mb10\"></div>\n                            <div className=\" datasetselectdiv scrollwindow layerwindow\">\n                                {datasetImageList}\n                            </div>\n                            <div className=\"\">\n                                <div className=\" iblock boldtext  boldtext datasetdescription mr10 mb5  p10 greyhighlight\">{this.state.datasetsList[this.state.selecteddataset].name.toUpperCase()}</div>\n                                <div onClick={this.toggleDatasetModal.bind(this)} className=\"iblock p10 greyhighlight clickable unselectable greymoreinfo\"> ? More Info </div>\n                            </div>\n\n                        </div>\n                        <div style={{ zIndex: 100 }} className=\"flex3  mr10\">\n                            <div className=\" pb10 sectiontitle\" > Select Model </div>\n                            <div className=\"horrule mb10\"></div>\n                            <div ref=\"modelscrollbox\" className=\"datasetselectdiv scrollwindow layerwindow\">\n                                {modelImageList}\n                            </div>\n                            <div className=\"flex flexwrap pr10\">\n                                <div className=\"  mr10 \">\n                                    {/* <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\"> {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase()}</div> */}\n                                    <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\">{this.state.modelsList[this.state.selectedmodel].name.toUpperCase()}</div>\n                                </div>\n                                <div className=\"flexfull \">\n                                    {/* <div className=\"smalldesc boldtext pt4\"> Layer [ {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index}  of {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].totallayers}  ] {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].type} </div> */}\n                                    <div className=\"smalldesc pt4\"> <strong> {makeFriendly(this.state.modelsList[this.state.selectedmodel].modelparameters)} Parameters  </strong>  </div>\n                                    <div className=\"smalldesc pt3\"> {this.state.modelsList[this.state.selectedmodel].numlayers} layers  </div>\n                                </div>\n                            </div>\n\n                        </div>\n                        <div style={{ zIndex: 100 }} className=\"flex3 pr10 \">\n                            <div className=\"pb8 sectiontitle \" >\n                                <div className=\"iblock\">\n                                    Select Layer\n                                </div>\n\n                                <div className=\"iblock \">\n                                    <Tooltip\n                                        direction=\"left\"\n                                        triggerText=\"\"\n                                    >\n\n                                        <div className=\"wscore\">\n                                            We construct <span className=\"italics\">intermediate models</span> from the main model at each of\n                                            these layers. Each intermediate model has less parameters than the full model\n                                            and is used for feature extraction.\n                                        </div>\n\n                                    </Tooltip>\n                                </div>\n                            </div>\n                            <div className=\"horrule mb10\"></div>\n                            <div ref=\"layerscrollbox\" className=\"scrollwindow layerwindow  mr10\">\n                                <div className=\"windowcontent\"> {layerImageList} </div>\n                            </div>\n                            <div className=\"flex flexwrap pr10\">\n                                <div className=\"  mr10 \">\n                                    {/* <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\"> {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase()}</div> */}\n                                    <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\">{\" LAYER \" + this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index}</div>\n                                </div>\n                                <div className=\"flexfull \">\n                                    {/* <div className=\"smalldesc boldtext pt4\"> Layer [ {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index}  of {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].totallayers}  ] {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].type} </div> */}\n                                    <div className=\"smalldesc pt4\"> <strong>Type: {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].type} </strong> | <span className=\"smalldesc\"> {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase()}  </span> </div>\n                                    <div className=\"smalldesc pt3\"> {makeFriendly(this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].modelparameters)} model parameters </div>\n                                </div>\n                            </div>\n\n                        </div>\n\n                        <div className=\"flex2\">\n                            <div className=\"pb8 sectiontitle \" >\n                                <div className=\"iblock\">\n                                    Distance Metric\n                                    </div>\n\n                                <div className=\"iblock \">\n                                    <Tooltip\n                                        direction=\"left\"\n                                        triggerText=\"\"\n                                    >\n\n                                        <div className=\"wscore\">\n                                            The distance metric used to compute similarity between extracted features.\n                                            </div>\n\n                                    </Tooltip>\n                                </div>\n                            </div>\n\n                            <div className=\"horrule mb10\"></div>\n                            <div className=\"scrollwindow layerwindow \">\n                                <div className=\"windowcontent\"> {metricImageList} </div>\n                            </div>\n                            <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\"> {this.state.distanceMetricList[this.state.selectedmetric].toUpperCase()}</div>\n                        </div>\n                        <div className=\"horrule mb10\"></div>\n\n                    </div>}\n\n\n                    {/* show umap panel and content */}\n                    <div style={{ zIndex: 100 }} onClick={this.toggleUMAPView.bind(this)} className=\"unselectable mt10 p10 clickable  flex greymoreinfo\">\n                        <div className=\"iblock flexfull minwidth485\"> <strong> {!this.state.showumap && <span>&#x25BC;  </span>} {this.state.showumap && <span>&#x25B2;  </span>} </strong> Visualization of Embeddings (UMAP) for Extracted Features </div>\n                        <div className=\"iblock   \">\n                            <div className=\"iblock mr5\"> <span className=\"boldtext\"> {this.state.modelsList[this.state.selectedmodel].name.toUpperCase()} </span></div>\n                            <div className=\"iblock\">\n                                <div className=\"smalldesc\"> LAYER {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index} / {this.state.modelsList[this.state.selectedmodel].numlayers} </div>\n                            </div>\n                        </div>\n\n                    </div>\n\n                    {(this.state.showumap) &&\n                        <div className=\"flex modelconfigdiv p10\">\n                            <Scene\n                                setselected={this.setSelectedImage.bind(this)}\n                                data={{\n\n                                    dataset: this.state.datasetsList[this.state.selecteddataset].name,\n                                    selectedimage: this.state.hoversimimage,\n                                    model: this.state.modelsList[this.state.selectedmodel].name,\n                                    layerindex: this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index,\n                                    layer: this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name,\n                                    dml: this.state.datasetsList[this.state.selecteddataset].name + this.state.modelsList[this.state.selectedmodel].name + this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name + this.state.hoversimimage\n                                }}\n                            >\n                            </Scene>\n                        </div>\n                    }\n\n                </div>\n\n\n                {/* top results */}\n                {/* show top results panel and content */}\n                {(this.state.showtopresults || this.searchCount > 0) &&\n                    <div>\n                        <div className=\"unselectable mt10    flex \">\n                            <div onClick={this.toggleTopX.bind(this)} className=\" iblock clickable greymoreinfo flexfull minwidth485 p10\"> <strong> {!this.state.showtopresults && <span>&#x25BC;  </span>} {this.state.showtopresults && <span>&#x25B2;  </span>} </strong>\n                                <strong>Top {this.state.topx} results </strong>  based on your search configuration\n                                <span className=\"smalldesc\"> [\n                                    <strong> MODEL: </strong> {this.state.modelsList[this.state.selectedmodel].name.toUpperCase()} |\n                                    <strong> LAYER: </strong>  {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index} |\n                                    <strong> DISTANCE METRIC: </strong>   {this.state.distanceMetricList[this.state.selectedmetric].toUpperCase()} ]\n                                </span>\n                            </div>\n\n                            <div onClick={this.toggleShowCompare.bind(this)} className={\" boldtext greenmoreinfo clickable bluehighlight justifycenter p10 flex flexcolumn \" + (this.state.showadvanced ? \"\" : \"displaynone\")}>\n                                ? Compare Models\n                            </div>\n\n\n\n                            {/* <div className=\"iblock   \">\n                        <div className=\"iblock mr5\"> <span className=\"boldtext\"> {this.state.modelsList[this.state.selectedmodel].name.toUpperCase()} </span></div>\n                        <div className=\"iblock\">\n                            <div className=\"smalldesc\">  LAYER {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index} / {this.state.modelsList[this.state.selectedmodel].numlayers} </div>\n                        </div>\n                    </div> */}\n\n                        </div>\n\n                    </div>\n                }\n\n                {\n                    <div ref=\"topresultsbox\" className=\"sliderboxcontainer transition3s\">\n                        <div className={\" sliderbox topconfig\" + (this.state.showtopresults ? \" open\" : \" closed\")}>\n\n                            <div ref=\"glowbar\" className=\"glowbar transitionw6s mb7 w0\"></div>\n                            <div className=\"flex \">\n                                <div className=\"iblock h100 positionrelative  mr10\">\n                                    <img src={selectedImagePath} className=\"mainsimilarityimage rad4  iblock\" alt=\"\" />\n                                    <div className=\"mt5  mainsimilaritytitle   lightbluehightlight\">\n                                        <div className=\"boldtext iblock mediumdesc mr5\"> SELECTED IMAGE  </div>\n                                        <div className=\"iblock smalldesc pt5 \"> {selectedCat.toUpperCase()}  <strong>  </strong></div>\n                                    </div>\n\n\n                                    {/* <div> searchimi number {this.state.selectedsimimage}</div> */}\n                                </div>\n                                <div className=\" flexfull\">\n                                    <div className=\"scrollwindow layerwindow \">\n                                        <div className=\" iblock mr10 rad3 \">\n                                            <div className=\"pb5 smalldesc \"> Search result score </div>\n                                            <div className=\"topscorediv\">\n\n                                                <div className=\"mainscore  topmainscore\"> {((modelScore / totalScore) * 100).toFixed(1) + \"%\"} </div>\n\n                                                <div className=\"weightedscore smalldesc textaligncenter\">\n                                                    <Tooltip\n                                                        triggerText=\"What is this?\"\n                                                    >\n\n                                                        <div className=\"wscore\">\n                                                            This is the percentage of returned results that belong to the same category\n                                                        as the selected image (weighted by position in the result list). For the current\n                                                        search, <strong>{simCount} / {this.state.topx} results </strong>  are in same category <strong>({selectedCat.toUpperCase()})</strong>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Note that this score is conservative - some images may belong to different classes but\n                                                        are <span className=\"italics\"> similar </span> (e.g sedan, beetle, ferrari are <span className=\"italics\">all</span> cars).\n                                                        </div>\n\n                                                    </Tooltip>\n                                                </div>\n                                            </div>\n\n                                        </div>\n                                        {similarImagesList.slice(1, this.state.topx + 1)}\n                                        <br />\n                                        <br />\n                                    </div>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>}\n\n                {this.state.showtopresults &&\n                    <div className=\"mb5 pt5 mediumdesc lhmedium textalignright mr10\">\n                        Search results not awesome? <strong>Hint:</strong> Try a different model or layer.\n                    </div>\n                }\n\n\n\n\n                {/* daset div */}\n\n                <div className=\"\">\n                    {/* <div className=\"horrule mt10\"></div> */}\n                    <div className=\"mb10 mt10 \">\n                        {/* <div onClick={this.toggleViewDatasetBy.bind(this)} className={\"p10 greyhighlight clickable unselectable greymoreinfo iblock mr10\"}> {this.state.viewalldataset ? \" View Images by Category\" : \"View All Images in Dataset\"}   </div> */}\n                        <div onClick={this.toggleViewDatasetBy.bind(this)} className={\"p10 greytab greyhighlight clickable unselectable greymoreinfo iblock mr5 \" + (this.state.viewdatasetby == \"all\" ? \"active\" : \"\")} viewby=\"all\">  All </div>\n                        <div onClick={this.toggleViewDatasetBy.bind(this)} className={\"p10 greytab greyhighlight clickable unselectable greymoreinfo iblock mr10 \" + (this.state.viewdatasetby == \"category\" ? \"active\" : \"\")} viewby=\"category\">  By  Category </div>\n                        {/* <div onClick={this.toggleViewDatasetBy.bind(this)} className={\"p10 greytab greyhighlight clickable unselectable greymoreinfo iblock mr10 \" + (this.state.viewdatasetby == \"graph\" ? \"active\" : \"\")} viewby=\"graph\">  Graph </div> */}\n\n                        <div className=\"boldtext sectiontitle  iblock   h100 mt10  mr10\"> DATASET: [ {this.state.datasetsList[this.state.selecteddataset].name.toUpperCase()} ] </div>\n                        <div className=\"iblock pt10\">  {this.state.datasetsList[this.state.selecteddataset].description}   </div>\n                    </div>\n                    {/* <div className=\"horrule mb10\"></div> */}\n                    {/* <div className=\"mt10 mb10\">\n                          \n                    </div> */}\n                    <div className=\"lightbluehightlight mb10 \"> Click an image to search for other similar images. </div>\n                    <div className=\"  scrollwindow  datasetdivbox\">\n                        {this.state.viewdatasetby == \"all\" && datasetimagesList}\n                        {this.state.viewdatasetby == \"category\" && datasetClassImagesList}\n\n                        {/* { this.state.viewalldataset?  datasetimagesList: datasetClassImagesList}  */}\n                    </div>\n                </div>\n\n                <br />\n                <br />\n                <br />\n                <br />\n                <br />\n                <br />\n            </div>\n        );\n    }\n}\n\nexport default SemanticEx;","import React, { Component } from \"react\";\nimport HeaderMessage from \"./HeaderMessage\"\nclass ModelsModalContent extends Component {\n    render() {\n        return (\n            <div className=\"mr10\">\n                <HeaderMessage></HeaderMessage>\n                \n                <br/>\n        \n                This section of the prototype allows you to <strong>view visualizations</strong> of the channels (groups of neurons) across layers in \n                9 convolutional neural network models (pretrained on imagenet).\n\n                <br />\n                 \n                 \n                <div className=\"horrule mb10 pt10\"></div>\n                <div className=\"boldtext\"> Convolutional Neural Netwoks</div>\n                CNNs learn hierarchical representations\n                useful for image analysis. Early layers in a CNN learn low level features (e.g. lines, edges, shapes, colours)\n                while later layers learn high level concepts (e.g eyes, legs, faces, doors etc) depending on the dataset used for training.\n\n\n                 <div className=\"boldtext mt10\"> Interpretability via Visualizations </div>\n                 Interpretable models are models we can \"understand\". One way to achieve this is to visualize the features learned by \n                 neurons (or groups of neurons) in the model. In this section of the prototype, we present visualizations \n                 from 30 random channels (groups of neurons) from layers in several models \n                 (vgg16, vgg19, mobilenet,  mobilenetv2, efficientnetb0, efficientnetb5, xception,  resnet50, inceptionv3, densenet121, nasnetmobile).\n                 \n                \n                 {/* <img className=\"mt10 w100\" src={process.env.PUBLIC_URL + \"/assets/semsearch/images/model.gif\"} alt=\"\" />\n                 <div className=\"smalldesc mb10\">Selecting a model shows a list of some of its layers. Selecting a layer shows visualizations of its channels.</div> */}\n\n<br />\n                 {/* An observation of these images show how complexity of learned features increases with deeper layers in the model. */}\n                 \n                Note: A layer must be differentiable in order to be visualized using optimization approaches, hence not all layers are visualized.\n                A selection of 30 channels are chosen for convenience.\n\n                \n                <div className=\"boldtext mt10\"> What do the images mean? </div>\n                Each model architecture shown (e.g vgg16, vgg19 etc) have all been pretrained on the imagenet dataset.\n                These images/visualizations represent an example of what the given neurons have  <span className=\"italics\"> learned to look for</span>.\n                They are <span className=\"italics\"> generated </span> using \n                an iterative <a href=\"https://distill.pub/2017/feature-visualization/\" target=\"_blank\" rel=\"noopener noreferrer\"> optimization </a> process which synthesizes input that causes the neurons to have high activation. \n                The process begins with random noise (an image that looks like 80's tv static).\n\n                This image is then shown to the channel and on its gradients (derivatives), the image pixels are updated to arrive at a final image that maximally excites the channel.  \n                <br/> Note: While the resulting visualizations may not all correspond to identifiable objects/concepts, \n                we consistently see increasingly complex patterns  as we progress\n                through the layers in the model. Further reading on visualizations of neurons:  <a href=\"https://distill.pub/2017/feature-visualization/\" target=\"_blank\" rel=\"noopener noreferrer\">here</a> and <a  target=\"_blank\" rel=\"noopener noreferrer\" href=\"http://yosinski.com/deepvis\">here</a> .\n\n                <br />  \n                \n                <div className=\"boldtext mt10\"> What library is used to create the visualizations? </div>\n                Channel images are generated using the <a href=\"https://github.com/tensorflow/lucid/tree/master/lucid\" target=\"_blank\" rel=\"noopener noreferrer\" >Lucid Library</a>  which\n                 implements optimization based  <a href=\"https://distill.pub/2017/feature-visualization/\" target=\"_blank\" rel=\"noopener noreferrer\"> feature visualization  </a> for neurons, channels, logits and layers of a neural network. \n\n                 <br /> \n                 <br /> \n                 \n            </div>\n        );\n    }\n}\n\nexport default ModelsModalContent;","import React, { Component } from \"react\";\nimport { DataTable, Modal, Tooltip } from 'carbon-components-react';\nimport ModelsModalContent from \"../../components/modals/ModelsModal\"\nimport {registerGAEvent, greyColor, blueColor, abbreviateString, makeFriendly, checkInView, animOptions, LeaderLine } from \"../../components/helperfunctions/HelperFunctions\"\nimport \"./modelex.css\"\n\nconst {\n    TableContainer,\n    Table,\n    TableHead,\n    TableRow,\n    TableBody,\n    TableCell,\n    TableHeader,\n} = DataTable\n\n\nconst headers = [\n    { key: 'layer_index', header: '', },\n    { key: 'name', header: 'Layer', },\n    { key: 'type', header: 'Type', },\n    { key: 'numneurons', header: 'Channels', },\n    { key: 'parametercount', header: 'Parameters', },\n];\nclass ModelEx extends Component {\n\n\n    constructor(props) {\n        super(props);\n\n        const modelDetailsViz = require('../../assets/models/models.json');\n        const modelDetails = require('../../assets/models/model_details.json');\n\n        let nList = []\n        const {model, layer} = {\n            model: modelDetails[\"models\"][0].name ,\n            layer: modelDetails[\"models\"][0].layers[0].name ,\n        }\n        let currentLayers = modelDetailsViz[model]\n        let neuronList = currentLayers[layer] \n\n        this.state = {\n            selectedmodel: 0,\n            selectedlayer: 0,\n            selectedneuron: 0,\n            modelsList: modelDetails[\"models\"],\n            layersList: modelDetailsViz[modelDetails[\"models\"][0].name],\n            neuronList: neuronList,\n            showmodelorientationmodal: !this.props.pageviewed,\n            showmoremodelinfomodal: false,\n            showneuronsubset: true,\n            numneuronsshow: 30,\n\n        }\n\n        this.layerList = modelDetailsViz\n        this.pageIntro = ` Convolutional Neural Network models are comprised of layers which learn heirarchical \n        representations. What kind of representations or features does each layer learn? \n        Well, let us explore the following models. `\n        // this.allLayerDetails = modelDetails[\"all_layers\"]\n        this.lastclicked = \"model\"\n\n        this.keyFunction = this.keyFunction.bind(this);\n        this.scrollEndedHandler = this.scrollEndedHandler.bind(this)\n        this.lineHolder = []\n    }\n\n    drawLines(e) {\n        this.removeLines()\n        let self = this;\n        let layers = this.state.modelsList[this.state.selectedmodel].layers\n        let containerOffset = -60\n        let elementOffset = -1 * self.refs[\"modelscrollbox\"].offsetTop - 30\n        // console.log(\"offsettop\", self.refs[\"modelscrollbox\"].offsetTop)\n        let modelVisible = checkInView(self.refs[\"modelscrollbox\"], self.refs[\"modelimg\" + this.state.selectedmodel], true, containerOffset, elementOffset)\n\n        let maxLineWidth = 3.5\n        let minLineWidth = 1.5\n        let incs = (maxLineWidth - minLineWidth) / layers.length\n\n        layers.forEach(function (each, i) {\n\n            let layerVisible = checkInView(self.refs[\"layerscrollbox\"], self.refs[\"layerimg\" + i], true, containerOffset, elementOffset)\n            if (layerVisible && modelVisible) {\n                // console.log(\"we drawing to\", i) \n\n                let line = new LeaderLine(self.refs[\"modelimg\" + self.state.selectedmodel], self.refs[\"layerimg\" + i], {\n                    color: self.state.selectedlayer == (i + \"\") ? blueColor : greyColor,\n                    startPlug: 'disc',\n                    endPlug: 'disc',\n                    startPlugColor: blueColor,\n                    path: \"fluid\",\n                    size: Math.min(minLineWidth + i * incs, maxLineWidth),\n                    hide: true,\n                    startSocket: 'bottom',\n                    endSocket: self.state.selectedlayer == i ? \"top\" : 'left',\n                    endPlugSize: maxLineWidth / Math.min(minLineWidth + i * incs, maxLineWidth),\n\n                });\n                document.querySelector('.leader-line').style.zIndex = -100\n                // animOptions.duration = self.state.selectedlayer == (i + \"\") ? 800 : 200;\n                line.show(\"draw\", animOptions)\n                self.lineHolder.push({ line: line, index: i })\n            }\n        })\n\n    }\n    removeLines(e) {\n        this.lineHolder.forEach(function (each) {\n            each.line.remove()\n        })\n        this.lineHolder = []\n    }\n    recolorLines(e) {\n        let self = this\n        if (this.LayerScrollTop != this.refs[\"layerscrollbox\"].scrollTop) {\n            this.LayerScrollTop = this.refs[\"layerscrollbox\"].scrollTop\n            this.drawLines()\n        } else {\n            this.lineHolder.forEach(function (each) {\n                if (each.index == self.state.selectedlayer) {\n                    each.line.hide(\"none\")\n                    each.line.color = blueColor\n                    // animOptions.duration = self.state.selectedlayer == each.index ? 800 : 200;\n                    each.line.show(\"draw\", animOptions)\n                    each.line.endSocket = \"top\"\n                } else {\n                    each.line.color = greyColor\n                    each.line.endSocket = \"left\"\n                }\n            })\n        }\n    }\n\n\n\n    getNextVal(newVal, maxVal) {\n        if (newVal >= 0) {\n            return newVal % maxVal\n        } else {\n            return (maxVal - Math.abs(newVal))\n        }\n\n    }\n    cycleLayerModel(val) {\n        if (this.lastclicked == \"model\") {\n            let newState = this.getNextVal((this.state.selectedmodel * 1 + val), this.state.modelsList.length);// Math.max((this.state.selectedmodel*1 + val) % this.state.modelsList.length, 0) \n             \n            if (!(isNaN(newState))) {\n               this.updateModelState(newState)\n            }\n\n        } else if (this.lastclicked == \"layer\") {\n            let newState = this.getNextVal((this.state.selectedlayer * 1 + val), this.state.modelsList[this.state.selectedmodel].layers.length)\n            if (!(isNaN(newState))) {\n                this.updateLayerState(newState)\n            }\n\n        } else if (this.lastclicked == \"neuron\") {\n\n            let numNeurons = (this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name].length)\n            let newState = this.getNextVal((this.state.selectedneuron * 1 + val), numNeurons)\n            // console.log(this.state.selectedneuron,newState,  val, numNeurons)\n            if (!(isNaN(newState))) {\n                this.setState({ selectedneuron: newState })\n            }\n\n        }\n    }\n\n    keyFunction(event) {\n        if (event.keyCode === 37) {\n            this.cycleLayerModel(-1)\n        }\n        else if (event.keyCode === 39) {\n            this.cycleLayerModel(1)\n        }\n\n    }\n\n    componentDidMount() { \n        let self = this\n        document.title = \"ConvNet Playground | Model Explorer\";\n\n        // Load query string parameters if available\n\n        const queryString = require('query-string');  \n        if (this.props.location.includes(\"channel\")) {\n\n            // hide orientation model\n            this.setState({showmodelorientationmodal: false})\n            const { model, layer, channel } = queryString.parse(this.props.location);\n            console.log(\"query string\", model, layer, channel, self.state.modelsList.length)\n            \n            // this.state.modelsList.forEach((each, i) => {\n            for (let i = 0; i < self.state.modelsList.length; i++) { \n                let each = self.state.modelsList[i]\n               \n                \n                if (each.name == model) {\n                    \n                    self.setState({ selectedmodel: i }, () => {\n                        self.state.modelsList[i].layers.forEach((each,j) => { \n                            if (each.name == layer) {\n                                self.setState({ selectedlayer: j }, () => {\n                                    console.log(self.getNeuronList())\n                                    let nlist = self.getNeuronList()\n                                    nlist.forEach((each, k) => { \n                                        if (each == channel) {\n                                            self.setState({selectedneuron: k})\n                                        }\n                                    });\n                                });\n                            }\n                        });\n                        \n                    }); \n                   \n                    break;\n                } \n            };\n        }\n      \n\n\n        document.addEventListener(\"keydown\", this.keyFunction, false);\n        this.drawLines()\n        this.LayerScrollTop = 0\n        window.addEventListener('resize', this.scrollEndedHandler)\n\n        this.refs[\"layerscrollbox\"].addEventListener(\"scroll\", this.scrollEndedHandler, false)\n        this.refs[\"modelscrollbox\"].addEventListener(\"scroll\", this.scrollEndedHandler, false)\n\n        //timer on when component mounted\n        this.componentLoadedTime = (new Date()).getTime()\n    }\n\n    updateNeuronList() { \n       \n        this.setState({ neuronList: this.getNeuronList() })\n        // console.log(\"updateNeuronList called\")\n    }\n\n    getNeuronList() {\n        const {model, layer} = this.getSelections(); \n        let currentLayers = this.layerList[model]\n        let neuronList = currentLayers[layer] \n        // console.log(neuronList)\n        return neuronList\n    }\n\n    getSelections() {\n       \n        return {\n            model: this.state.modelsList[this.state.selectedmodel].name ,\n            layer: this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name ,\n        };\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener(\"keydown\", this.keyFunction, false);\n        window.removeEventListener('resize', this.scrollEndedHandler)\n        this.removeLines();\n\n        this.refs[\"layerscrollbox\"].removeEventListener(\"scroll\", this.scrollEndedHandler, false)\n        this.refs[\"modelscrollbox\"].removeEventListener(\"scroll\", this.scrollEndedHandler, false)\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.selectedmodel !== prevState.selectedmodel) {\n            this.drawLines()\n           \n            \n        }\n        if (this.state.selectedlayer !== prevState.selectedlayer) {\n            this.recolorLines() \n        }\n \n    }\n\n    updateModelState(val) { \n            this.setState({ selectedlayer: 0 }, () => {\n                this.setState({ selectedmodel: val }, () => { \n                    this.updateNeuronList() \n                })\n                \n           }) \n          \n    }\n\n    updateLayerState(val) {\n        this.setState({ selectedlayer: val }, () => {\n            this.updateNeuronList() \n        })\n        this.setState({ selectedneuron: 0 }, () => {\n           \n        })\n    }\n\n    clickModelImage(e) {\n        registerGAEvent(\"modelexplorer\",\"modelchange\", this.state.modelsList[e.target.getAttribute(\"indexvalue\")].name, this.componentLoadedTime)\n        this.updateModelState(e.target.getAttribute(\"indexvalue\") )\n        this.lastclicked = \"model\"\n    }\n\n    clickLayerImage(e) {\n        this.updateLayerState(e.target.getAttribute(\"indexvalue\"))\n        this.lastclicked = \"layer\"\n    }\n\n\n    clickNeuronImage(e) {\n        const {model, layer} = this.getSelections(); \n        registerGAEvent(\"modelexplorer\",\"channelselect\", model + \",\" + layer + \",\" + e.target.getAttribute(\"indexvalue\") , this.componentLoadedTime)\n        // this.setState({selectedneuronpath: e.target.getAttribute(\"pathinfo\")  })\n        this.setState({ selectedneuron: e.target.getAttribute(\"indexvalue\") })\n        this.lastclicked = \"neuron\"\n\n    }\n\n\n    toggleModelMoreInfoModal(e) {\n        this.setState({ showmoremodelinfomodal: !(this.state.showmoremodelinfomodal) })\n    }\n\n    toggleViewNeuronSubset(e) {\n       \n        this.setState({ showneuronsubset: !(this.state.showneuronsubset) })\n    }\n\n    toggleModelsModal(e) {\n        e.preventDefault()\n        registerGAEvent(\"modelexplorer\",\"modelmodal\", this.state.showmodelorientationmodal ? \"close\" : \"open\", this.componentLoadedTime)\n        this.setState({ showmodelorientationmodal: !(this.state.showmodelorientationmodal) })\n        // console.log(this.state.showmodelorientationmodal) \n    }\n\n    kepressLayer(e) {\n        console.log(e.keyCode)\n    }\n\n    scrollEndedHandler() {\n        window.clearTimeout(this.isScrolling);\n        let self = this\n        this.isScrolling = setTimeout(function () {\n            self.drawLines()\n        }, 200);\n    }\n\n\n\n    twitterShare(e) {\n        e.preventDefault();\n\n        let neuron = this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name][this.state.selectedneuron];\n        let modelname = this.state.modelsList[this.state.selectedmodel].name\n        let layer = this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name\n        let fflurl = \"http://convnetplayground.fastforwardlabs.com/#/models?model=\" + modelname + \"&layer=\" + layer + \"&channel=\" + neuron\n        let url = \"https://twitter.com/intent/tweet?url=\" + encodeURIComponent(fflurl) + \"&via=\" + \"fastforwardlabs\" + \"&text=\" + encodeURIComponent(\"A visualization of channel \" + neuron + \" in the \" + layer + \" layer  of a \" + modelname + \" model. View more visualizationss of CNNs and an interactive visualization of semantic image search in the #convnetplayground prototype.\");\n\n        window.open(url, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600')\n    }\n\n    render() {\n        // let modelInterpretabilityIntro = `Interpretable models are models we can \"understand\". \n        // Interpretability explores approaches to better understand neural networks. For example, \n        // how can we \"peek\" into a CNN to get an idea of what each neuron in a layer has learned to detect? `    \n\n        // let optimizationVisualization = `  \n        // Within this approach to visualizing layers and neurons,\n        // we begin with random noise and update it (based on gradients) to maximally excite each neuron. \n        // The  <a href=\"https://github.com/tensorflow/lucid/tree/master/lucid\" target=\"_blank\">Lucid</a> library is used to generate visualizations for layers in the models below.\n        // `\n\n        let modelImageList = this.state.modelsList.map((mdata, index) => {\n            let selectedModel = this.state.modelsList[index].name\n            let selectedlayer = this.state.modelsList[index].layers[this.state.modelsList[index].layers.length - 1].name\n\n            let imagePath = process.env.PUBLIC_URL + \"/assets/models/\" + selectedModel + \"/\" + selectedlayer + \"/0.jpg\"\n            // console.log(imagePath)\n            return (\n\n                <div ref={\"modelimgbox\" + index} key={mdata.name + \"fullbox\" + index} className=\"iblock datasetfullbox clickable mb10 \">\n                    <div className=\"datasettitles\"> {abbreviateString(mdata.name.toUpperCase(), 10)}</div>\n                    <div className=\"smalldesc pb5\">{makeFriendly(mdata[\"modelparameters\"])} params. </div>\n\n                    <img ref={\"modelimg\" + index} onClick={this.clickModelImage.bind(this)} src={imagePath} alt=\"\" className={\"datasetbox rad2 \" + (this.state.selectedmodel == index ? \"active\" : \"\")} indexvalue={index} />\n                </div>\n            )\n        });\n\n        let selectedModel = this.state.modelsList[this.state.selectedmodel].name \n        let selectedlayer = this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name\n         \n        let layerImageList = this.state.modelsList[this.state.selectedmodel].layers.map((ldata, index) => {\n            let selectedModel = this.state.modelsList[this.state.selectedmodel].name\n            let selectedlayer = this.state.modelsList[this.state.selectedmodel].layers[index].name\n            let neuronList = this.layerList[selectedModel][selectedlayer]\n            let imagePath = process.env.PUBLIC_URL + \"/assets/models/\" + selectedModel + \"/\" + selectedlayer + \"/\" + neuronList[neuronList.length - 1] + \".jpg\";\n\n            return (\n                <div key={ldata + \"fullbox\" + index} className=\"iblock datasetfullbox clickable mb10 \">\n                    <div className=\"datasettitles\"> {\"layer \" + ldata.layer_index} </div>\n                    <div className=\"smalldesc pb5\"> {abbreviateString(ldata.name, 11).toLowerCase()} </div>\n                    <img ref={\"layerimg\" + index} onKeyPress={this.kepressLayer.bind(this)} onClick={this.clickLayerImage.bind(this)} src={imagePath} alt=\"\" className={\"datasetbox rad2 \" + (this.state.selectedlayer == index ? \"active\" : \"\")} indexvalue={index} />\n                </div>\n            )\n        });\n      \n\n        // this.state.neuronList = neuronList\n        // this.setState({neuronList: neuronList })\n        // console.log(this.state.neuronList)\n        let neuronImageList = this.state.neuronList.map((ldata, index) => {\n            let imagePath = process.env.PUBLIC_URL + \"/assets/models/\" + selectedModel + \"/\" + selectedlayer + \"/\" + ldata + \".jpg\"\n          \n            return (\n                <div key={ldata + \"fullbox\" + index} className=\"iblock datasetfullbox clickable mb10 \">\n                    <div className=\"datasettitles\"> Channel {ldata}</div>\n                    <img onClick={this.clickNeuronImage.bind(this)} src={imagePath} alt=\"\" className={\"neuronbox rad2 \" + (this.state.selectedneuron == index ? \"active\" : \"\")} indexvalue={index} pathinfo={imagePath} neuronindex={ldata} />\n                </div>\n            )\n        }); \n\n\n        // console.log(this.state.modelsList[this.state.selectedmodel].all_layers)\n\n        return (\n\n            <div>\n                {(this.state.showmodelorientationmodal) && <Modal className=\"orientationmodal\"\n                    open={true}\n                    size=\"lg\"\n                    aria-label=\"Model Modal\"\n                    // style={{maxWidth: '1600px', width: '100%'}}\n                    passiveModal={false}\n                    primaryButtonText=\"Get Started\"\n                    // secondaryButtonText=\"Close\"\n                    modalHeading=\"Model Explorer\"\n                    modalLabel=\"ConvNet Playground\"\n                    onRequestSubmit={this.toggleModelsModal.bind(this)}\n                    onRequestClose={this.toggleModelsModal.bind(this)}\n                >\n                    <ModelsModalContent></ModelsModalContent>\n\n                </Modal>}\n\n                {(this.state.showmoremodelinfomodal) && <Modal className=\"orientationmodal\"\n                    open={true}\n                    size=\"lg\"\n                    // style={{maxWidth: '1600px', width: '100%'}}\n                    passiveModal={true}\n                    primaryButtonText=\"Get Started\"\n                    // secondaryButtonText = \"Do not show this again\"\n                    modalHeading={this.state.modelsList[this.state.selectedmodel].name.toUpperCase()}\n                    // modalLabel= \"How this demo works\"\n                    onRequestSubmit={this.toggleModelMoreInfoModal.bind(this)}\n                    onRequestClose={this.toggleModelMoreInfoModal.bind(this)}\n                >\n                    <div>\n                        <DataTable\n                            rows={this.state.modelsList[this.state.selectedmodel].all_layers}\n                            headers={headers}\n                            render={({ rows, headers, getHeaderProps }) => (\n                                <TableContainer className=\"boldtext\" title={\"List of layers in  \" + this.state.modelsList[this.state.selectedmodel].name.toUpperCase() + \" Model\"} >\n                                    <Table>\n                                        <TableHead>\n                                            <TableRow>\n                                                {headers.map(header => (\n                                                    <TableHeader {...getHeaderProps({ header })}>\n                                                        {header.header}\n                                                    </TableHeader>\n                                                ))}\n                                            </TableRow>\n                                        </TableHead>\n                                        <TableBody>\n                                            {rows.map(row => (\n                                                <TableRow key={row.id}>\n                                                    {row.cells.map(cell => (\n                                                        <TableCell key={cell.id}>{cell.value}</TableCell>\n                                                    ))}\n                                                </TableRow>\n                                            ))}\n                                        </TableBody>\n                                    </Table>\n                                </TableContainer>\n                            )}\n                        />\n                    </div>\n\n                </Modal>}\n\n\n\n                <div className=\" flex  \">\n                    <div className=\"iblock sectiontitle flexfull   pt4 \">Model Explorer</div>\n                    <div className=\"flex5  \">\n                        <div onClick={this.toggleModelsModal.bind(this)} className=\"iblock floatright  clickable showmore\"> ? More Info  </div>\n                    </div>\n                </div>\n                {/* <div className=\"horrule\"></div> */}\n                {/* <InlineNotification\n                    title={\"Image Algebra\"} \n                    kind={\"info\"} \n                    subtitle={this.pageIntro}\n                    style={{ minWidth: '100%', marginBottom: '.5rem' }}\n                /> */}\n\n                <div className=\"flex\">\n                <div className=\"flex5 mr10 mynotif lh10 instructions lightbluehightlight maxh16\">\n                    <div className=\"boldtext pb5 advancedoptionsbox\"> Optimization Based Feature Visualization </div>\n                    This demo allows you to explore visualizations of patterns learned by channels (groups of neurons) in each layer of a Convolutional Neural Network (pretrained on <strong> imagenet</strong>).\n                    \n                    To begin, <strong> click </strong>  on a model, and a layer to view visualizations of selected channels in that layer.\n    \n                </div>\n                    \n                <div className=\"flex5 mynotif lh10 instructions lightbluehightlight maxh16\">\n                        <div className=\"boldtext pb5 advancedoptionsbox\"> What do these images mean? </div>\n                    \n                These images/visualizations represent an <span className=\"italics\">example</span> of what the given neurons in the pretrained model have  <span className=\"italics\"> learned to look for </span>.\n                They are <span className=\"italics\"> generated </span> using \n                an interative <a href=\"https://distill.pub/2017/feature-visualization/\" target=\"_blank\" rel=\"noopener noreferrer\"> optimization</a> process which synthesizes input that causes \n                        the neurons to have high\n                activation.  <a onClick={this.toggleModelsModal.bind(this)} href=\"\">Learn more.</a>\n                       \n                </div>\n                    \n               </div>\n\n                {/* <div className=\"flex mt10\">\n                    <div className=\"flex5 mr10 mynotif lightbluehightlight p20\">\n                        <div className=\"boldtext mb10\"> Interpretability via Visualizations</div>\n                        <div className=\"lh10 maxh16\">{modelInterpretabilityIntro}</div>\n                    </div>\n                    <div className=\"flex5  mynotif lightbluehightlight p20\">\n                        <div className=\"boldtext mb10\"> Optimization-based Feature Visualization</div>\n                        <div className=\"lh10 maxh16\">\n                        Within this approach to visualizing layers and neurons,\n                        we begin with random noise and update it (based on gradients) to maximally excite each neuron. \n                        The  <a href=\"https://github.com/tensorflow/lucid/tree/master/lucid\" target=\"_blank\">Lucid</a> library is used to generate visualizations for layers in the models below.\n                        `\n                        </div>\n                    </div>\n\n                </div> */}\n\n                <div style={{ zIndex: 100 }} className=\"flex flexwrap \">\n                    <div style={{ zIndex: 500 }} className=\"flex4 mr10\">\n                        <div className=\"mt20 pb10 sectiontitle\" > Select Model </div>\n                        <div className=\"horrule mb10\"></div>\n                        <div ref=\"modelscrollbox\" className=\"scrollwindow  scrollwindowmodel\">\n                            {modelImageList}\n                        </div>\n\n                        <div>\n                            <div className=\" iblock  boldtext datasetdescription mr10 p10 greyhighlight\">{this.state.modelsList[this.state.selectedmodel].name.toUpperCase()}</div>\n                            <div onClick={this.toggleModelMoreInfoModal.bind(this)} className=\"iblock p10  greyhighlight unselectable greymoreinfo clickable\"> ? More Info</div>\n                        </div>\n\n                    </div>\n\n\n                    <div style={{ zIndex: 100 }} className=\"flex6 mr10\">\n                        <div className=\"mt20 pb10 sectiontitle\" > Select Layer </div>\n                        <div className=\"horrule mb10\"></div>\n                        <div ref=\"layerscrollbox\" className=\"scrollwindow layerwindow  \">\n                            <div className=\"windowcontent\"> {layerImageList} </div>\n                        </div>\n                        <div className=\"flex flexwrap pr10\">\n                            <div className=\"  mr10 \">\n                                {/* <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\"> {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase()}</div> */}\n                                <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\">{\" LAYER \" + this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index}</div>\n                            </div>\n                            <div className=\"flexfull \">\n                                {/* <div className=\"smalldesc boldtext pt4\"> Layer [ {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index}  of {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].totallayers}  ] {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].type} </div> */}\n                                <div className=\"smalldesc pt4\"> <strong>Type: {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].type} </strong> | <span className=\"smalldesc\"> {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase()}</span> </div>\n                                <div className=\"smalldesc pt3\"> {makeFriendly(this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].parametercount)} trainable parameters, {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].numneurons} channels </div>\n                            </div>\n                        </div>\n\n                    </div>\n\n                    <div style={{ zIndex: 100 }} className=\"\">\n                        <div className=\"mt20 pb8 sectiontitle\" >\n\n                            <div className=\"iblock\">\n                                Channel Vizualization\n                            </div>\n\n                            <div className=\"iblock\">\n                                <Tooltip\n                                    direction=\"left\"\n                                    triggerText=\"\"\n                                >\n\n                                    <div className=\"wscore\">\n                                        This is an example of an image that \"maximally excites\" neurons in\n                                    channel <strong> {this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name][this.state.selectedneuron]}</strong> of layer <strong>{this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index}</strong>  in the <strong>  {this.state.modelsList[this.state.selectedmodel].name} </strong>  model.\n                                    Learn more about how this is generated <a className=\"whitetext\" href=\"https://distill.pub/2017/feature-visualization/\" target=\"_blank\" rel=\"noopener noreferrer\"> here</a>.\n                                </div>\n\n                                </Tooltip>\n                            </div>\n\n                        </div>\n                        <div className=\"horrule mb10\"></div>\n                        <div className=\"  \">\n                            <img className=\"enlargedneuron rad4\" src={process.env.PUBLIC_URL + \"/assets/models/\" + selectedModel + \"/\" + selectedlayer + \"/\" + this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name][this.state.selectedneuron] + \".jpg\"} alt=\"\" />\n                        </div>\n                        <div className=\"flex flexwrap pr10\">\n                            <div className=\" mt10  mr10 \">\n                                {/* <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\"> {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase()}</div> */}\n                                <div className=\" iblock boldtext datasetdescription  p10 greyhighlight\"> Channel : {this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name][this.state.selectedneuron]}  </div>\n                            </div>\n                            <div className=\"flexfull mt5 \">\n                                <div className=\"smalldesc viewchanneldesc  iblock pt4\"> View  <strong> {neuronImageList.length} </strong>  more channels from  layer  <strong>  {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index} </strong> below </div>\n                                {/* <div className=\"smalldesc boldtext pt4\"> {abbreviateString(this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase(), 26)}: {this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name][this.state.selectedneuron]} / {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].numneurons} </div> */}\n                                {/* <div className=\"smalldesc pt4\"> <strong>Type: {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].type} </strong> | <span className=\"smalldesc\"> {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase()}</span> </div> */}\n                                {/* <div className=\"smalldesc pt3\"> {makeFriendly(this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].parametercount)} trainable parameters, {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].numneurons} channels </div> */}\n                            </div>\n                        </div>\n\n                    </div>\n\n\n                </div>\n\n\n                <div className=\"mt20 mb10 \">\n                    <div onClick={this.toggleViewNeuronSubset.bind(this)} className={\"p10 greytab greyhighlight clickable unselectable greymoreinfo iblock mr5 \" + (this.state.showneuronsubset  ? \"active\" : \"\")} viewby=\"all\"> Top {Math.min(neuronImageList.length, this.state.numneuronsshow)} Channels </div>\n                    <div onClick={this.toggleViewNeuronSubset.bind(this)} className={\"p10 greytab greyhighlight clickable unselectable greymoreinfo iblock mr10 \" + (!this.state.showneuronsubset ? \"active\" : \"\")} viewby=\"category\">  All Channels ({neuronImageList.length}) </div>\n                        \n                    <div className=\"sectiontitle iblock mr10 mt20\"> Visualizations  of {this.state.showneuronsubset ? Math.min(this.state.numneuronsshow, neuronImageList.length) : neuronImageList.length} Channels  in layer {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].layer_index} of {this.state.modelsList[this.state.selectedmodel].name.toUpperCase()} </div>\n                    {/* <div className=\"iblock\"> A selection of channels in the current layer.</div> */}\n                </div>\n\n                <div className=\"horrule mb10\"></div>\n\n                <div className=\"flex flexwrap\">\n                    <div className=\"flex1  \">\n                        <div className=\"enlargeddiv rad2 mr10\">\n                            {/* let selectedModel = this.state.modelsList[this.state.selectedmodel].name\n        let currentLayers = this.layerList[selectedModel] \n        let selectedlayer = this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name\n        let neuronList = currentLayers[selectedlayer] */}\n\n\n\n                            <div onClick={this.twitterShare.bind(this)} className=\"mb10\" > <div className=\"twitterbutton unselectable p10 clickable  flex greymoreinfo\" href=\"\"> Share on twitter </div> </div>\n                            <div className=\"boldtext enlargeddesc mb5  smalldesc\">{abbreviateString(this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name.toUpperCase(), 26)}: {this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name][this.state.selectedneuron]} / {this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].numneurons} </div>\n                            <img className=\"enlargedneuron rad4\" src={process.env.PUBLIC_URL + \"/assets/models/\" + selectedModel + \"/\" + selectedlayer + \"/\" + this.layerList[this.state.modelsList[this.state.selectedmodel].name][this.state.modelsList[this.state.selectedmodel].layers[this.state.selectedlayer].name][this.state.selectedneuron] + \".jpg\"} alt=\"\" />\n\n                        </div>\n                    </div>\n                    <div className=\"flexfull \">\n\n                        <div className=\" scrollwindow neurondivbox \">\n                            {this.state.showneuronsubset && neuronImageList.slice(0, Math.min(neuronImageList.length, this.state.numneuronsshow))}\n                            {!this.state.showneuronsubset && neuronImageList }\n                        </div>\n                    </div>\n\n                </div>\n\n\n\n\n                <br />\n                <br />\n                <br />\n            </div >\n        );\n    }\n}\n\nexport default ModelEx;","import React, { Component } from \"react\";\nimport \"./faq.css\"\n\n\nclass FAQ extends Component {\n\n    constructor(props) {\n        super(props);\n\n\n\n        this.state = {\n            // selecteddataset: this.datasetslist[0]\n        }\n\n\n        this.algebraIntro = ` CNNs work really well. They are data hungry and also energy hungry!\n         Estimating how much energy (and compute) is needed to run a prediction for each model architecture can be\n         an important heuristic that informs how you build online prediction apis.`\n\n    }\n\n    componentDidMount() {\n        document.title = \"ConvNet Playground | FAQ \";\n    }\n\n    clickDatasetImage() {\n        alert(\"click here\")\n\n    }\n\n\n    render() {\n\n        return (\n            <div>\n                {/* <div className=\"pb10 sectiontitle\"> Q: What is ConvNet Playground! </div>\n                <div className=\"mb20 lh10 answerarea\">\n                    Convnet Playground -  <i> is a tool for the interactive exploration of Convolutional Neural Networks (Convnets or CNNs)</i>.\n                    It focuses on the use case of <span className=\"boldtext\">\"semantic image search\"</span>  which allows us search for images by content.\n                    To implement this, a Convolutional Neural Network <span className=\"italics\"> looks </span> at the content of an images\n                    and can find all other images similar to that image.\n                    It also provides an interface for viewing the features learned by layers in a pretrained CNN.\n               </div> */}\n\n\n                <div className=\"pb10 sectiontitle pt4\"> Q:  So .. What are Convolutional Neural Networks? </div>\n                {/* <div className=\"horrule mb10\"></div> */}\n                <div className=\"lh10 mb20 answerarea\">\n                    Convolutional Neural Networks (CNN or ConvNet) are a class\n                    of <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://en.wikipedia.org/wiki/Deep_learning#Deep_neural_networks\">deep neural networks</a> mostly \n                    applied to the task of image analysis.\n                    CNNs learn hierarchical representations which are useful for multiple tasks - early layers in a CNN learn low level features \n                    (e.g. colours, lines, edges, shapes) while later layers learn high level concepts (e.g eyes, legs, faces, doors, etc.) \n                    depending on the dataset used for training. For more information on ConvNets, we\n                    recommend the <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"http://cs231n.stanford.edu/\">CS231n Stanford Course</a> .\n               </div>\n\n                <div className=\"pb10 sectiontitle\"> Q: What questions can I ask with ConvNet Playground? </div>\n                {/* <div className=\"horrule mb10\"></div> */}\n                <div className=\"lh10 mb20 answerarea\">\n\n                ConvNet playground focuses on  a simple example of \n                    semantic search using \n                        \n                neural networks - <span className=\" italics\">\n                   given a dataset of existing images, and a new arbitrary image (search query), find a subset of images from the \n                        dataset that are most similar to the new image.       \n                </span>\n                    \n                &nbsp; In this implementation, we extract features (embeddings) for images in our dataset and compute similarity as the distance between these embeddings.\n                    We perform this using multiple configurations (datasets, models, layers distance metrics) \n                    and allow the user to interactively ask questions of the results.\n                    \n    \n                <ul className=\"pt10 pb10\">\n                        <li>\n                            <span className=\"boldtext\"> - How does semantic search (with pretrained models) perform?  </span>\n                            \n                            Hint: We included a search score to <span className=\"italics\">quantify</span> how well each model works for a given query.  \n                            Explore this with the top search results view and search score metric.\n                            </li>\n                        <li> \n                            <span className=\"boldtext\"> - How well does each model/layer configuration capture “semantic meaning” for a given dataset?  </span>\n                            Hint: A good model should extract embeddings where similar images are close to each other, \n                            and dissimilar images are far from each other. \n                            You can explore this using the UMAP embeddings visualization view (advanced options). \n\n                        </li>\n                        <li>\n                            <span className=\"boldtext\"> - For a given search query, how does search performance compare for each model/layer configuration? </span>\n                             Hint: Use  the compare models view  (advanced options).\n                        </li>\n                        <li>\n                            <span className=\"boldtext\"> - What type of features/patterns are detected by various layers in a pretrained model? </span>\n                             Hint: Use  the model explorer tab to view examples of patterns learned by  layers in 8 models pretrained on imagenet.\n                        </li>\n                        <li></li>\n                    </ul>\n                    \n                    <div className=\" pb10\">\n                        Note that the approach in this prototype (use of features from pretrained models) is relatively simple and \n                        hence has limitations (scale, matching multiple objects in search query, accuracy). \n                        In practice, we can extend this work by fine-tuning specialized models for given datasets, \n                        leveraging additional information (e.g text descriptions, interaction logs, purchase logs etc)\n                        in constructing more meaningful embeddings or \n                        using a two stage approach for matching multiple objects in the search query (extract object crops and use as search queries). \n                    </div>\n                    \n                    \n                \n                        \n                    \n    \n                    {/* <div className=\"flex flexwrap\">\n                        <div className=\"flex35 answerarea mr10\">\n                            <div>\n                                <div> How well do features from a layer capture similarity in a dataset?</div>\n                                <div> <strong>Hint: </strong> Try the UMAP visualization view.</div>\n                                 \n                            </div>\n                        </div>\n                        <div className=\"flex35 answerarea mr10\">\n                            <div>\n                                How do models compare for a given search query?\n                                <br />\n                                <strong>Hint:</strong> Use the search score metric, compare results from each model/layer.</div>\n                        </div>\n                        <div className=\"flex3 answerarea\">\n                            <div> What features are learned by the models in each layer?</div>\n                            <div> <strong>Hint: </strong> Try model explorer view.</div>\n                             \n                        </div>\n                    </div> */}\n\n\n\n                </div>\n\n\n                <div className=\"pb10 sectiontitle\">Q:  Does all of this run in realtime?</div>\n                {/* <div className=\"horrule mb10 \"></div> */}\n                <div className=\"lh10 answerarea mb20\">\n                    No. We have precomputed all of the values beforehand. We have extracted features from all images in our dataset\n                    using layers (intermediate models) from all supported models. We have also precomputed the similarity between each of these features\n                    and show these results based on your selections.\n               </div>\n\n                <div className=\"pb10 sectiontitle\">Credits</div>\n                <div className=\"lh10 answerarea mb10 pb20\">\n                    This project was created by Victor Dibia (<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://twitter.com/vykthur\">@vykthur</a>) at Fast Forward Labs.\n                    It builds on many related projects and tools aimed at making Neural Networks more accessible\n                    via interactive experiences. Some of these related projects include  &nbsp;\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://distill.pub/2017/feature-visualization/\">Feature Visualization,</a> &nbsp;\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://playground.tensorflow.org\">Tensorflow Playground,</a> &nbsp;\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://teachablemachine.withgoogle.com\">Teachable Machine,</a> &nbsp;\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://transcranial.github.io/keras-js/#/\">Keras.js </a> &nbsp; and many others.&nbsp;\n                    ConvNet Playground uses\n                    the <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/tensorflow/lucid/tree/master/lucid\">lucid</a> and <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/totti0223/lucid4keras\">lucid4keras</a> libraries\n                    to visualize features learned by channels in a\n                    layer, <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://anseki.github.io/leader-line/\">leader-line </a> for drawing svg lines\n                    and <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://www.carbondesignsystem.com/\">carbon</a> design system for layout.\n                    Pre trained models used in this project are sourced from the <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://keras.io/applications/\">Keras applications</a>  module, \n                    efficientnets implementation from <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/qubvel/efficientnet\">here</a>. \n                  Thanks to Grant Custer for valuable <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://observablehq.com/@bryakas/using-three-js-for-2d-data-visualization\">pointers on Three.js</a> and the rest of the\n                                Fast Forward Labs team for feedback and guidance!\n                     \n                </div>\n\n\n                <br />\n                <br/><br/>\n            </div>\n        );\n    }\n}\n\nexport default FAQ ","import React, { Component } from \"react\";\nimport ReactGA from 'react-ga';\nimport {\n    Route,\n    HashRouter,\n\n} from \"react-router-dom\";\n\nimport { Modal } from 'carbon-components-react';\n\n\nimport \"./template.css\"\n\n// import Sidebar from \"./Sidebar\";\nimport AppHeader from \"./header/AppHeader\";\nimport Footer from \"./footer/Footer\";\nimport SemanticEx from \"../content/semanticex/SemanticEx\";\nimport ModelEx from \"../content/modelex/ModelEx\";\nimport FAQ from \"../content/faq/FAQ\";\nimport CompareVisualization from \"../components/comparevisualization/CompareVisualization\"\nimport Scene from \"../components/three/Scene\"\n// import About from \"../sections/About\"\n// import Game from \"../sections/Game\"\n// import Doodle from \"../sections/Doodle\"\n// import VideoDemo from \"../sections/VideoDemo\"\n\nimport { createBrowserHistory } from 'history';\n\n\nReactGA.initialize(\"UA-53030428-17\")\nReactGA.pageview(window.location.pathname + window.location.search);\nconst history = createBrowserHistory({\n    basename: \"\", // The base URL of the app (see below)\n    forceRefresh: false, // Set true to force full page refreshes\n    keyLength: 6, // The length of location.key\n    // A function to use to confirm navigation with the user (see below)\n    getUserConfirmation: (message, callback) => callback(window.confirm(message))\n});\n// history.listen(location => {\n//     ReactGA.set({ page: location.hash })\n//     ReactGA.pageview(location.hash)\n//     // console.log(location.pathname, location.hash)\n// })\n\nlet linkHolder = {}\n\nfunction updateLh(location) {\n\n    if (location.hash in linkHolder) {\n        linkHolder[location.hash] = linkHolder[location.hash] + 1\n    } else {\n        linkHolder[location.hash] = 0\n    }\n\n}\n\nhistory.listen(location => {\n    updateLh(location)\n    // ReactGA.set({ page: location.hash })\n    ReactGA.pageview(location.hash)\n    // console.log(\"react ga sent\", location.hash)\n});\n\n\nclass Main extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n        }\n\n        // console.log(window.location)\n        updateLh(window.location)\n    }\n\n    componentDidMount() {\n        // ReactGA.pageview(window.location.hash)\n        // document.title = \"Image Analysis Explorer | Explore Convolutional Neural Nets for Imagee Analysis\";\n    }\n\n    // toggleOrientationModal(e) {\n    //     this.setState({ showorientationmodal: !(this.state.showorientationmodal) })\n    //     // console.log(this.state.showorientationmodal)\n    // }\n\n\n\n\n    render() {\n        const mScene = (props) => {\n            return (\n                <Scene\n                    setselected={function (val) { }}\n                    data={{\n                        dataset: \"tinyimagenet\",\n                        model: \"xception\",\n                        layer: \"block14_sepconv2_act\",\n                        dml: \"bingo\",\n                        selectedimage: \"0\",\n                        layerindex: 1\n                    }}\n                />\n            );\n        }\n\n        const myModalComponent = (props) => {\n            return (\n                <ModelEx\n                    pageviewed={linkHolder[window.location.hash] > 0 ? true : false}\n                    lh={linkHolder}\n                    location={window.location.hash.replace(\"/models?\", \"\")}\n                />\n            );\n        }\n\n        const myCompareComponent = (props) => {\n            this.modelDetails = require('../assets/semsearch/details.json');\n            this.datasetdictionary = require('../assets/semsearch/datasetdictionary.json');\n\n            return (\n\n                <CompareVisualization\n                    data={{\n                        metric: \"cosine\",\n                        selectedimage: 127,\n                        numLayers: 8,\n                        numModels: 7,\n                        dataset: \"iconic200\",\n                        topx: 10,\n                        chartWidth: 280,\n                        chartHeight: 220,\n                        datasetdictionary: this.datasetdictionary,\n                        modelDetails: this.modelDetails\n                    }}\n                />\n            );\n        }\n\n\n\n\n\n        const mySemanticComponent = (props) => {\n            return (\n                <SemanticEx\n                    pageviewed={linkHolder[window.location.hash] > 0 ? true : false}\n                    lh={linkHolder}\n                />\n            );\n        }\n\n        return (\n            <HashRouter>\n                <AppHeader></AppHeader>\n\n                <div className=\"container-fluid p10\">\n                    <Route exact path=\"/\" component={mySemanticComponent} />\n                    <Route exact path=\"/models\" component={myModalComponent} />\n                    <Route exact path=\"/scene\" component={mScene} />\n                    <Route exact path=\"/faq\" component={FAQ} />\n                    <Route exact path=\"/test\" component={myCompareComponent} />\n\n                </div>\n                <div id=\"footer\"> <Footer /> </div>\n            </HashRouter>\n\n        );\n    }\n}\n\nexport default Main;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Main from \"./components/Main\"; \nimport * as serviceWorker from './serviceWorker';\n\nimport \"./components/template.scss\" \n// import 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(\n    <Main />,\n    document.getElementById(\"root\")\n);\n\nserviceWorker.register()","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAKpJREFUaAXt0rENwDAMxMAk+y+pSWLALTeg6FId//zOzP8set+i1ptasF084YRlC/SlZaDISRiTyA4Jy0CRkzAmkR0SloEiJ2FMIjskLANFTsKYRHZIWAaKnIQxieyQsAwUOQljEtkhYRkochLGJLJDwjJQ5CSMSWSHhGWgyEkYk8gOCctAkZMwJpEdEpaBIidhTCI7JCwDRU7CmER2SFgGipyEMYnssE74AKuIBBpevYWDAAAAAElFTkSuQmCC\""],"sourceRoot":""}